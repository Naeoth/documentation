<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>User manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src=".//javascripts/steps.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/source-utils.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/highlight-lines.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/collapse-lines.js"></script>
<script type="text/javascript" src=".//javascripts/tabcontainer.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css"
/> -->
<link rel="stylesheet" type="text/css" href=".//styles/custom-styles.css" />
<link rel="stylesheet" type="text/css" href=".//styles/tabcontainer.css" />
<link rel="stylesheet" type="text/css" href=".//styles/steps.css" />
<link rel="stylesheet" type="text/css" href=".//styles/sourcecode/collapse-lines.css" />
<link rel="stylesheet" type="text/css" href=".//styles/sourcecode/highlight-lines.css" />
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>User manual</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_vocabulary">Vocabulary</a></li>
<li><a href="#_prerequisites">Prerequisites</a>
<ul class="sectlevel2">
<li><a href="#_nodejs_and_npm">NodeJS and npm</a></li>
<li><a href="#_git">Git</a></li>
</ul>
</li>
<li><a href="#_workflow_initialization">Workflow initialization</a>
<ul class="sectlevel2">
<li><a href="#_i_have_an_existing_account">I have an existing account</a></li>
<li><a href="#_i_don_t_have_zetapush_account">I don&#8217;t have ZetaPush account</a></li>
</ul>
</li>
<li><a href="#_create_a_new_application">Create a new application</a>
<ul class="sectlevel2">
<li><a href="#_initialization_with_the_cli">Initialization with the CLI</a></li>
<li><a href="#_i_create_an_application_without_account">I create an application without account</a></li>
<li><a href="#_i_use_an_existing_application">I use an existing application</a></li>
<li><a href="#_i_create_a_new_application_on_my_account">I create a new application on my account</a></li>
</ul>
</li>
<li><a href="#_manual_introduction">Manual introduction</a>
<ul class="sectlevel2">
<li><a href="#_what_do_we_need_to_do">What do we need to do ?</a></li>
<li><a href="#_details_by_file">Details by file</a></li>
<li><a href="#_use_your_application">Use your application</a></li>
</ul>
</li>
<li><a href="#_custom_cloud_service">Custom Cloud Service</a>
<ul class="sectlevel2">
<li><a href="#_what_is_a_em_custom_cloud_service_em">What is a <em>custom cloud service</em></a></li>
<li><a href="#_how_to_create_a_em_custom_cloud_service_em">How to create a <em>custom cloud service</em></a></li>
<li><a href="#_use_a_em_cloud_service_em_inside_my_em_custom_cloud_service_em">Use a <em>cloud service</em> inside my <em>custom cloud service</em></a></li>
<li><a href="#_use_an_other_em_custom_cloud_service_em_in_my_own">Use an other <em>custom cloud service</em> in my own</a></li>
<li><a href="#_expose_my_em_custom_cloud_services_em">Expose my <em>custom cloud services</em></a></li>
<li><a href="#_complete_example">Complete example</a></li>
</ul>
</li>
<li><a href="#_use_services">Use services</a>
<ul class="sectlevel2">
<li><a href="#_requirements">Requirements</a></li>
<li><a href="#_use_a_service">Use a service</a></li>
</ul>
</li>
<li><a href="#_deployment">Deployment</a>
<ul class="sectlevel2">
<li><a href="#_what_is_deployment">What is deployment ?</a></li>
<li><a href="#_requirements_2">Requirements</a></li>
<li><a href="#_how_to_deploy_your_application">How to deploy your application ?</a></li>
<li><a href="#_how_to_deploy_only_the_em_worker_em">How to deploy only the <em>worker</em> ?</a></li>
</ul>
</li>
<li><a href="#_configuration_management">Configuration management</a>
<ul class="sectlevel2">
<li><a href="#_account_configuration">Account configuration</a></li>
<li><a href="#_application_configuration">Application configuration</a></li>
<li><a href="#_configuration_override">Configuration override</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_vocabulary"><a class="anchor" href="#_vocabulary"></a>Vocabulary</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">Word</th>
<th class="tableblock halign-center valign-middle">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ZetaPush Account</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Developer account on the ZetaPush platform to create and manage applications</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Credentials</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Couple Login/Password of the developer ZetaPush account</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cloud service</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Class with methods (cloud functions) provided by ZetaPush. For example we have many cloud services : Chat, Group, Messaging&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cloud function</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">A method of a Cloud Service. For example : createUser(), sendMessage()&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Custom Cloud Service</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">This is a class lile a Cloud Service, but this is the developer that create this class and its methods. We use similary a Cloud Service and a Custom Cloud Service</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Front</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Front end part of your application (HTML / CSS / JS)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Worker</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Back end part of your application written in JavaScript (Node). Generally you put your business logic inside it</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Organization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Grouping of ZetaPush accounts</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Application</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Logic container which gathers a frontend and backend part on one or several environment</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Environment</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">State of your application, for example : prod, pre-prod, dev&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CLI</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Command Line Interface : Used to run your code or deploy your application for example</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Console</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Administration website to manage ZetaPush account, applications, see documentation&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_nodejs_and_npm"><a class="anchor" href="#_nodejs_and_npm"></a>NodeJS and npm</h3>
<div class="paragraph">
<p>Go to <a href="https://nodejs.org/en/download/" target="_blank">NodeJS Downloads</a> and follow installation instructions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>NodeJS is used to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>develop custom cloud services</p>
</li>
<li>
<p>run custom cloud services</p>
</li>
<li>
<p>deploy your application on ZetaPush</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You may also need to install additionnal tools for NodeJS:</p>
</div>
<div class="paragraph tab-container">
<p>Additional tools</p>
</div>
<div class="paragraph tab">
<p>Windows</p>
</div>
<div class="paragraph">
<p>You must install development tools on Windows (Visual Studio Build Tools and Python).
Hopefully, there is a npm tool that helps to install all required dependencies.
You must run this command line using <strong>PowerShell</strong> as <strong>Administrator</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">npm install --global --production windows-build-tools</code></pre>
</div>
</div>
<div class="paragraph tab">
<p>Debian/Ubuntu</p>
</div>
<div class="paragraph">
<p>Install build tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">sudo apt-get install -y build-essential</code></pre>
</div>
</div>
<div class="paragraph tab">
<p>Enterprise Linux and Fedora</p>
</div>
<div class="paragraph">
<p>Install build tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">sudo yum install gcc-c++ make
# or: sudo yum groupinstall 'Development Tools'</code></pre>
</div>
</div>
<div class="paragraph tab-container-end">
<p>-</p>
</div>
</div>
<div class="sect2">
<h3 id="_git"><a class="anchor" href="#_git"></a>Git</h3>
<div class="paragraph">
<p>Go to <a href="https://git-scm.com/downloads" target="_blank">Git Downloads</a> and follow the installation instructions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Git is used by ZetaPush when you use our tool to create a project (see: <a href="#_initialization_with_the_cli">Create a new application using the CLI</a>)
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_workflow_initialization"><a class="anchor" href="#_workflow_initialization"></a>Workflow initialization</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_i_have_an_existing_account"><a class="anchor" href="#_i_have_an_existing_account"></a>I have an existing account</h3>
<div class="sect3">
<h4 id="_i_want_to_use_an_existing_application"><a class="anchor" href="#_i_want_to_use_an_existing_application"></a>I want to use an existing application</h4>
<div class="imageblock">
<div class="content">
<img src="init-with-account-and-app.png" alt="init with account and app" width="379" height="352">
</div>
</div>
<div class="paragraph">
<p>➊ I launch <code>npm init @zetapush myApp</code> with the <em>developer-login</em>, <em>developer-password</em> and <em>appName</em> properties</p>
</div>
<div class="paragraph">
<p>➋ An application is created in your workspace</p>
</div>
<div class="paragraph">
<p>➌ The <em>.zetarc</em> file is like :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myAppName</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_i_want_to_create_a_new_application"><a class="anchor" href="#_i_want_to_create_a_new_application"></a>I want to create a new application</h4>
<div class="imageblock">
<div class="content">
<img src="init-with-account-without-app.png" alt="init with account without app" width="338" height="352">
</div>
</div>
<div class="paragraph">
<p>➊ I launch <code>npm init @zetapush myApp</code> with the <em>developer-login</em> and <em>developer-password</em> properties</p>
</div>
<div class="paragraph">
<p>➋ An application is created in your workspace</p>
</div>
<div class="paragraph">
<p>➌ The <em>.zetarc</em> file is like :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If the <em>appName</em> property in the <em>.zetarc</em> is empty or missing, ZetaPush deploy or execute the code on a new application.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_i_don_t_have_zetapush_account"><a class="anchor" href="#_i_don_t_have_zetapush_account"></a>I don&#8217;t have ZetaPush account</h3>
<div class="imageblock">
<div class="content">
<img src="init-without-account.png" alt="init without account" width="379" height="460">
</div>
</div>
<div class="paragraph">
<p>➊ I launch <code>npm init @zetapush myApp</code> without parameters</p>
</div>
<div class="paragraph">
<p>➋ You type your email and a password to create your ZetaPush account</p>
</div>
<div class="paragraph">
<p>➌ An application is created in your workspace</p>
</div>
<div class="paragraph">
<p>➍ The <em>.zetarc</em> file is like :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">nameOfAppAutoGenerated</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You need to validate your ZetaPush account to run or deploy your application.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_a_new_application"><a class="anchor" href="#_create_a_new_application"></a>Create a new application</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_initialization_with_the_cli"><a class="anchor" href="#_initialization_with_the_cli"></a>Initialization with the CLI</h3>
<div class="paragraph">
<p>You can generate a classic application with the following command :</p>
</div>
<div class="listingblock">
<div class="title">Generate application</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm init @zetapush myApp <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><em>myApp</em> is the name of my generated application</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This command works only with npm &gt;= 6. Otherwise, read this <a href="#_using_npm_lower_than_6">section</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This command can takes many parameters :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>--developer-login</strong> : Define which developer login (ZetaPush account) use</p>
</li>
<li>
<p><strong>--developer-password</strong> : Define which developer password (ZetaPush account) use</p>
</li>
<li>
<p><strong>--appName</strong> : Define which application use</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This will generate a tree structure of a classic application :</p>
</div>
<div class="listingblock">
<div class="title">Generated tree structure</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">myApp
├── .zetarc
├── .gitignore
├── front
│   ├── index.html
│   └── index.js
├── worker
│   └── index.js
├── README.md
└── package.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>All dependencies are already installed, so you can run your application locally or deploy it.</p>
</div>
<div class="paragraph">
<p>To do this you can use the <em>CLI</em> using the commands : <code>zeta run</code> and <code>zeta push</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To install the CLI you can launch : <code>npm install -g @zetapush/cli</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The CLI dependency is already installed and npm scripts are created. So you can execute your code with <code>npm run start</code> and deploy your application with <code>npm run deploy</code>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Definition of generated files</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">File / Folder</th>
<th class="tableblock halign-center valign-middle">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>.zetarc</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Contains the developer credentials. Useful to deploy or run your code. This content is auto generated if the file is empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>.gitignore</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Avoid you to publish your developer credentials (on GitHub for example)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>package.json</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Contains the dependencies of ZetaPush, the name of your app, the entry point of yours <em>custom cloud services</em> and many useful other informations for your application.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>README.md</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Give you some informations to use your application.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>front/</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">By convention, the front end code of your application is in this folder. You can change it by editing <code>package.json</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>worker/</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">By convention, the back end code of your application is in this folder. You can change it by editing <code>package.json</code>.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_using_npm_lower_than_6"><a class="anchor" href="#_using_npm_lower_than_6"></a>Using npm lower than 6</h4>
<div class="paragraph">
<p>If you using npm with a version lower than 6, you can upgrade your npm version with :</p>
</div>
<div class="listingblock">
<div class="title">Upgrade npm</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm install -g npm@latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or use <em>npx</em> to launch the script :</p>
</div>
<div class="listingblock">
<div class="title">Launch with npx</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npx @zetapush/create myApp</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will have the same result that using the classic command.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_i_create_an_application_without_account"><a class="anchor" href="#_i_create_an_application_without_account"></a>I create an application without account</h3>
<div class="paragraph">
<p>If you have no ZetaPush account, you can create a new and generate an application with the CLI.</p>
</div>
<div class="paragraph">
<p>The process is the following :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="init-without-account.png" alt="init without account" width="379" height="460">
</div>
</div>
<div class="paragraph">
<p>➊ I launch <code>npm init @zetapush myApp</code> without parameters</p>
</div>
<div class="paragraph">
<p>➋ You type your email and a password to create your ZetaPush account</p>
</div>
<div class="paragraph">
<p>➌ An application is created in your workspace</p>
</div>
<div class="paragraph">
<p>➍ The <em>.zetarc</em> file is like :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">nameOfAppAutoGenerated</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You need to validate your ZetaPush account to run or deploy your application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To validate your account you need to click on the link in the sent email.</p>
</div>
<div class="paragraph">
<p>Once your account is validate, you can launch <code>zeta run</code> or <code>zeta push</code> to execute or deploy your application.</p>
</div>
</div>
<div class="sect2">
<h3 id="_i_use_an_existing_application"><a class="anchor" href="#_i_use_an_existing_application"></a>I use an existing application</h3>
<div class="paragraph">
<p>If you want to deploy or execute your application on an existing application you can follow this process :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="init-with-account-and-app.png" alt="init with account and app" width="379" height="352">
</div>
</div>
<div class="paragraph">
<p>➊ I launch <code>npm init @zetapush myApp</code> with the <em>developer-login</em>, <em>developer-password</em> and <em>appName</em> properties</p>
</div>
<div class="paragraph">
<p>➋ An application is created in your workspace</p>
</div>
<div class="paragraph">
<p>➌ The <em>.zetarc</em> file is like :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myAppName</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example you can launch this command :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre>$ npm init @zetapush myApp
    --developer-login user@gmail.com
    --developer-password password
    --appName myAppName</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because your <code>.zetarc</code> has an existing application (<em>appName</em>), the CLI you execute or deploy your code on this one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_i_create_a_new_application_on_my_account"><a class="anchor" href="#_i_create_a_new_application_on_my_account"></a>I create a new application on my account</h3>
<div class="paragraph">
<p>If you have an existing account and you want to create a new application you can use the CLI.</p>
</div>
<div class="paragraph">
<p>The process is the following :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="init-with-account-without-app.png" alt="init with account without app" width="338" height="352">
</div>
</div>
<div class="paragraph">
<p>➊ I launch <code>npm init @zetapush myApp</code> with the <em>developer-login</em> and <em>developer-password</em> properties</p>
</div>
<div class="paragraph">
<p>➋ An application is created in your workspace</p>
</div>
<div class="paragraph">
<p>➌ The <em>.zetarc</em> file is like :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If the <em>appName</em> property in the <em>.zetarc</em> is empty or missing, ZetaPush deploy or execute the code on a new application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example you can launch :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
</pre></td>
  <td class="code"><pre>$ npm init @zetapush myApp
    --developer-login user@gmail.com
    --developer-password password</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is when you launch <code>zeta run</code> or <code>zeta push</code> that the CLI checks if an application name exists in the <code>.zetarc</code>. If there is no <em>appName</em>, the CLI executes or deploys the code on a new application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_manual_introduction"><a class="anchor" href="#_manual_introduction"></a>Manual introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_do_we_need_to_do"><a class="anchor" href="#_what_do_we_need_to_do"></a>What do we need to do ?</h3>
<div class="paragraph">
<p>To start a new application with ZetaPush Celtia, the easiest path is to use the <em>CLI</em>. But you can also start your application creating each file you need.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Above all, you need to have a ZetaPush account with an existing application. So you can create this with the <em>console</em> (Work in progress) or use the <em>CLI</em> with <code>npm init @zetapush myApp</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here the basic source tree you need to create :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">├── .zetarc
├── .gitignore
├── front
│   ├── index.html
│   └── index.js
├── worker
│   └── index.js
└── package.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see what you need to do for each file in the following section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_details_by_file"><a class="anchor" href="#_details_by_file"></a>Details by file</h3>
<div class="sect3">
<h4 id="__zetarc"><a class="anchor" href="#__zetarc"></a>.zetarc</h4>
<div class="paragraph">
<p>To specify which account (on the ZetaPush platform) you use for an application, you type the account informations in the <code>.zetarc</code>.</p>
</div>
<div class="paragraph">
<p>The format of this file is the <strong>JSON</strong>. The possible properties are below :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>developerLogin</em> : Login of the developer account on the ZetaPush platform</p>
</li>
<li>
<p><em>developerPassword</em> : Password of the developer account on the ZetaPush platform</p>
</li>
<li>
<p><em>appName</em> : The name of your application</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">.zetarc</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myAppName</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to create a new application, you can leave the <em>appName</em> property empty, this will create a new application and fill your <em>.zetarc</em> when you will run or deploy your code.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="__gitignore"><a class="anchor" href="#__gitignore"></a>.gitignore</h4>
<div class="paragraph">
<p>This file is optional but it is very useful if you want to avoid to publish your account informations on <em>GitHub</em> for example.</p>
</div>
<div class="paragraph">
<p>We recommend to create a <code>.gitignore</code> file with the following content by default :</p>
</div>
<div class="listingblock">
<div class="title">.gitignore</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
</pre></td>
  <td class="code"><pre>.zetarc <i class="conum" data-value="1"></i><b>(1)</b>
node_modules/ <i class="conum" data-value="2"></i><b>(2)</b></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Avoid to publish credentials</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Avoid to publish all node_modules</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_front"><a class="anchor" href="#_front"></a>front</h4>
<div class="paragraph">
<p>By convention, the directory contains the front code. For example you can have this tree structure :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">└── front
    ├── index.html
    └── index.js</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_basic_example_of_hello_world_with_custom_cloud_service"><a class="anchor" href="#_basic_example_of_hello_world_with_custom_cloud_service"></a>Basic example of Hello World (with custom cloud service)</h5>
<div class="listingblock">
<div class="title">front/index.html</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre></td>
  <td class="code"><pre><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attribute-name">charset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">viewport</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">width=device-width, initial-scale=1.0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
  <span class="tag">&lt;title&gt;</span>ZetaPush SDK Examples - Worker<span class="tag">&lt;/title&gt;</span>
  <span class="tag">&lt;style&gt;</span>
<span class="inline">    <span class="tag">body</span> {
      <span class="key">font-family</span>: <span class="value">Arial</span>, <span class="value">Helvetica</span>, <span class="value">sans-serif</span>;
    }
    <span class="tag">body</span><span class="pseudo-class">::before</span> {
      <span class="key">display</span>: <span class="value">block</span>;
      <span class="key">content</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Open Your Console</span><span class="delimiter">&quot;</span></span>;
      <span class="key">background</span>: <span class="color">#000</span>;
      <span class="key">color</span>: <span class="color">#FFF</span>;
      <span class="key">position</span>: <span class="value">fixed</span>;
      <span class="key">transform</span>: <span class="error">r</span><span class="error">o</span><span class="error">t</span><span class="error">a</span><span class="error">t</span><span class="error">e</span>(<span class="float">45deg</span>) <span class="error">t</span><span class="error">r</span><span class="error">a</span><span class="error">n</span><span class="error">s</span><span class="error">l</span><span class="error">a</span><span class="error">t</span><span class="error">e</span>(<span class="float">60px</span>, <span class="float">0px</span>);
      <span class="key">right</span>: <span class="float">0</span>;
      <span class="key">top</span>: <span class="float">0</span>;
      <span class="key">height</span>: <span class="float">25px</span>;
      <span class="key">padding</span>: <span class="float">5px</span> <span class="float">30px</span>;
      <span class="key">line-height</span>: <span class="float">25px</span>;
      <span class="key">font-family</span>: <span class="value">Calibri</span>, <span class="value">Helvetica</span>, <span class="value">Arial</span>;
      <span class="key">font-weight</span>: <span class="value">bold</span>;
    }
    <span class="tag">nav</span> {
      <span class="key">display</span>: <span class="value">flex</span>;
      <span class="key">flex-direction</span>: <span class="value">column</span>;
    }
    <span class="tag">button</span>,
    <span class="tag">label</span> {
      <span class="key">margin</span>: <span class="float">0.5</span><span class="value">rem</span> <span class="float">1</span><span class="value">rem</span>;
      <span class="key">height</span>: <span class="float">5</span><span class="value">vh</span>;
      <span class="key">font-size</span>: <span class="error">c</span><span class="error">a</span><span class="error">l</span><span class="error">c</span>(<span class="float">5</span><span class="value">vh</span> / <span class="float">2</span>);
      <span class="key">background</span>: <span class="error">l</span><span class="error">i</span><span class="error">n</span><span class="error">e</span><span class="error">a</span><span class="error">r</span><span class="error">-</span><span class="error">g</span><span class="error">r</span><span class="error">a</span><span class="error">d</span><span class="error">i</span><span class="error">e</span><span class="error">n</span><span class="error">t</span>(<span class="color">rgb(216, 216, 216)</span>, <span class="color">rgb(186, 186, 186)</span>);
      <span class="key">border-color</span>: <span class="color">rgb(117, 117, 117)</span> <span class="color">rgb(107, 107, 107)</span> <span class="color">rgb(97, 97, 97)</span>;
      <span class="key">border-style</span>: <span class="value">solid</span>;
      <span class="key">border-width</span>: <span class="float">1px</span>;
      <span class="key">padding</span>: <span class="float">1px</span> <span class="float">7px</span> <span class="float">2px</span>;
      <span class="key">text-align</span>: <span class="value">center</span>;
      <span class="key">cursor</span>: <span class="value">pointer</span>;
      <span class="key">box-sizing</span>: <span class="value">border-box</span>;
      <span class="key">align-items</span>: <span class="value">flex-start</span>;
    }
    <span class="tag">button</span>[<span class="attribute-name">disabled</span>],
    <span class="tag">label</span>[<span class="attribute-name">disabled</span>] {
      <span class="key">opacity</span>: <span class="float">0.9</span>;
      <span class="key">pointer-events</span>: <span class="value">none</span>;
      <span class="key">cursor</span>: <span class="value">not-allowed</span>;
      <span class="key">color</span>: <span class="value">graytext</span>;
    }</span>
  <span class="tag">&lt;/style&gt;</span>
<span class="tag">&lt;/head&gt;</span>

<span class="tag">&lt;body&gt;</span>
  <span class="tag">&lt;nav&gt;</span>
    <span class="tag">&lt;button</span> <span class="attribute-name">disabled</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">js-Hello</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>hello<span class="tag">&lt;/button&gt;</span>
  <span class="tag">&lt;/nav&gt;</span>
  <span class="tag">&lt;main&gt;</span>
    <span class="tag">&lt;ul&gt;</span><span class="tag">&lt;/ul&gt;</span>
  <span class="tag">&lt;/main&gt;</span>
  <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://unpkg.com/@zetapush/core</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>
  <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://unpkg.com/@zetapush/platform</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>
  <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">./index.js</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">front/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre><span class="comment">// Create new ZetaPush Client</span>
const client = <span class="keyword">new</span> ZetaPush.WeakClient({
  <span class="key">sandboxId</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">yourappname</span><span class="delimiter">&quot;</span></span>,
});

const api = client.createProxyTaskService();

client.connect().then(() =&gt; (
  console.debug(<span class="string"><span class="delimiter">'</span><span class="content">onConnectionEstablished</span><span class="delimiter">'</span></span>),
  [...document.querySelectorAll(<span class="string"><span class="delimiter">'</span><span class="content">button</span><span class="delimiter">'</span></span>)].forEach((node) =&gt;
    node.removeAttribute(<span class="string"><span class="delimiter">'</span><span class="content">disabled</span><span class="delimiter">'</span></span>),
  )
));

document.addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">DOMContentLoaded</span><span class="delimiter">'</span></span>, () =&gt; {
    document.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">.js-Hello</span><span class="delimiter">'</span></span>).addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">click</span><span class="delimiter">'</span></span>, (event) =&gt; {
        console.log(<span class="string"><span class="delimiter">'</span><span class="content">Hello world</span><span class="delimiter">'</span></span>, () =&gt; api.hello());
    });
});</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_worker"><a class="anchor" href="#_worker"></a>worker</h4>
<div class="paragraph">
<p>By convention, the directory contains the back code. For example you can have this tree structure :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">└── worker
    └── index.js</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_basic_example_of_hello_world_custom_cloud_service"><a class="anchor" href="#_basic_example_of_hello_world_custom_cloud_service"></a>Basic example of Hello World (custom cloud service)</h5>
<div class="listingblock">
<div class="title">worker/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td>
  <td class="code"><pre>module.exports = <span class="reserved">class</span> Api {
  <span class="comment">/**
   * Explicit injected platform services
   * @returns {Object[]}
   */</span>
  <span class="reserved">static</span> get parameters() { <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="keyword">return</span> [];
  }
  <span class="comment">/**
   * Api constructor
   */</span>
  constructor() {
    console.log(<span class="string"><span class="delimiter">'</span><span class="content">Api:constructor</span><span class="delimiter">'</span></span>)
  }

  <span class="comment">/**
   * Get an Hello World string with server side timestamp value
   * @returns {string}
   */</span>
  async hello() {
    <span class="keyword">return</span> <span class="error">`</span>Hello World from JavaScript <span class="predefined">$</span>{Date.now()}<span class="error">`</span>;
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Useful for dependencies injection, empty for this case</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_package_json"><a class="anchor" href="#_package_json"></a>package.json</h4>
<div class="paragraph">
<p>The <code>package.json</code> is the most important file in the application. It contains all informations needed to deploy or run your application on the ZetaPush platform (Except the credentials of the ZetaPush account in the <code>.zetarc</code>).</p>
</div>
<div class="paragraph">
<p>The minimal <code>package.json</code> is below :</p>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myApp</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">worker/index.js</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">dependencies</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/platform</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^0.18.2</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/cli</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^0.18.2</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Entry point of your <a href="#_worker">worker</a>. This is in this file that you will expose your <em>custom cloud services</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Dependency of the <em>ZetaPush Platform</em> to write some <em>custom cloud services</em> and access to existing <em>cloud services</em> exposed by ZetaPush</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Dependency to use the <a href="#_command_line_interface_cli">CLI</a> (Command Line Interface). It will be useful to run your worker or deploy your code.</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_path_of_the_code"><a class="anchor" href="#_path_of_the_code"></a>Path of the code</h5>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
By convention, ZetaPush Celtia considers that your front code is in the directory <code>front</code> and your back code (worker) in <code>worker</code>. You can change it by setting path in the <code>package.json</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is an example of application where the front code is in the directory <code>front/dist</code> and the back code in <code>server</code> :</p>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myApp</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">worker/index.js</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">dependencies</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/platform</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^0.18.2</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/cli</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^0.18.2</span><span class="delimiter">&quot;</span></span>
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">zetapush</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">front</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">./front/dist</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">worker</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">./server</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The front code to deploy is in the directory <code>front/dist</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The back code to deploy is in the directory <code>server</code></td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_install_dependencies"><a class="anchor" href="#_install_dependencies"></a>Install dependencies</h5>
<div class="paragraph">
<p>You need to install some dependencies in your application. To do this, you can run :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm install --save @zetapush/platform
$ npm install --save @zetapush/cli</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_your_application"><a class="anchor" href="#_use_your_application"></a>Use your application</h3>
<div class="paragraph">
<p>Once your have your application ready you can :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run the backend code (Worker) locally</p>
</li>
<li>
<p>Deploy your application</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To do this you need to use the <em>CLI</em>. To install it, launch :</p>
</div>
<div class="listingblock">
<div class="title">Install ZetaPush CLI</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ npm install -g @zetapush/cli</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the CLI, you can run your worker with :</p>
</div>
<div class="listingblock">
<div class="title">Run worker</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ zeta run</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or deploy your application with :</p>
</div>
<div class="listingblock">
<div class="title">Deploy the application</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ zeta push</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_custom_cloud_service"><a class="anchor" href="#_custom_cloud_service"></a>Custom Cloud Service</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_a_em_custom_cloud_service_em"><a class="anchor" href="#_what_is_a_em_custom_cloud_service_em"></a>What is a <em>custom cloud service</em></h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A <em>custom cloud service</em> combines many <em>cloud functions</em> like the <em>cloud services</em> exposed by ZetaPush. The only difference is that it is <strong>you</strong> that create the <em>cloud functions</em>.
Generally, we put the <strong>business logic</strong> of your application in the <em>custom cloud services</em>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_example"><a class="anchor" href="#_example"></a>Example</h4>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Your use-case is a basic real-time chat between <em>characters of Avengers</em> (See <a href="#_tutorial">tutorial</a>). You create the chat with the <em>cloud services</em> provided by ZetaPush and you want to add a new feature : Each <em>Avenger</em> has many skills/attacks and they can randomly use one of them on the chat.</p>
</div>
<div class="paragraph">
<p>To add this business logic, you can create a <em>custom cloud service</em> named <em>AvengerService</em> and into this, you add a <em>cloud function</em> named <em>sendMessage</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_architecture"><a class="anchor" href="#_architecture"></a>Architecture</h4>
<div class="sect4">
<h5 id="_development_phase"><a class="anchor" href="#_development_phase"></a>Development phase</h5>
<div class="imageblock">
<div class="content">
<img src="custom-cloud-service-dev.png" alt="Custom Cloud Service in development phase" width="1403" height="551">
</div>
<div class="title">Figure 1. Custom Cloud Service in development phase</div>
</div>
<div class="paragraph">
<p>The worker is running "locally" and interacts with the existing <em>cloud services</em> on the ZetaPush platform and the front code interacts <strong>only</strong> with the <em>custom cloud services</em> that is running "locally"</p>
</div>
</div>
<div class="sect4">
<h5 id="_production_phase"><a class="anchor" href="#_production_phase"></a>Production phase</h5>
<div class="imageblock">
<div class="content">
<img src="custom-cloud-service-prod.png" alt="Custom Cloud Service in production phase" width="318" height="352">
</div>
<div class="title">Figure 2. Custom Cloud Service in production phase</div>
</div>
<div class="paragraph">
<p>The front code interacts <strong>only</strong> with the <em>custom cloud services</em> that is running "locally"</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_create_a_em_custom_cloud_service_em"><a class="anchor" href="#_how_to_create_a_em_custom_cloud_service_em"></a>How to create a <em>custom cloud service</em></h3>
<div class="paragraph">
<p>First, a <em>custom cloud service</em> is a <code>class</code> and its <code>methods</code> are the  <em>cloud functions</em>. So the most basic example of <em>custom cloud service</em> is below :</p>
</div>
<div class="sect3">
<h4 id="_create_a_em_cloud_function_em"><a class="anchor" href="#_create_a_em_cloud_function_em"></a>Create a <em>cloud function</em></h4>
<div class="listingblock">
<div class="title">Basic custom cloud service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> HelloWorldAsCustomCloudService {

    constructor() {} <i class="conum" data-value="1"></i><b>(1)</b>

    helloWorld() { <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>;
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You always need to add a constructor in a <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>helloWorld</code> is your first <em>cloud function</em> in your <em>custom cloud service</em> named <strong>HelloWorldAsCustomCloudService</strong></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A <em>cloud function</em> is always asynchronous (with the <em>async</em> keyword or not)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <em>cloud function</em> in a <em>custom cloud service</em> must follow a specific format.
Only the first parameter is passed, the second is the context of the call.
For example :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> myCustomCloudService {
    constructor() {}

    myCloudFunction(parameters, context) { <i class="conum" data-value="1"></i><b>(1)</b>
        ...
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>parameters</code> is the first argument passed, it can be an object.
<code>context</code> is the context of the call for this <em>cloud function</em>.
For example you can get the ID of the caller by <code>context.owner</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On the front side, you can use this <em>cloud function</em> like this :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
</pre></td>
  <td class="code"><pre><span class="local-variable">this</span>.api.myCloudFunction({ <span class="key"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">toto</span><span class="delimiter">'</span></span>});
<span class="comment">// Or this.api.myCloudFunction('titi');</span></pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_a_em_cloud_service_em_inside_my_em_custom_cloud_service_em"><a class="anchor" href="#_use_a_em_cloud_service_em_inside_my_em_custom_cloud_service_em"></a>Use a <em>cloud service</em> inside my <em>custom cloud service</em></h3>
<div class="sect3">
<h4 id="_dependencies_injection"><a class="anchor" href="#_dependencies_injection"></a>Dependencies injection</h4>
<div class="paragraph">
<p>First of all, if you want to include some services (custom or not), you need to use <em>dependencies injection</em> of ZetaPush. All of your dependencies injection will be facilitated.</p>
</div>
<div class="paragraph">
<p>So, you need to import the package <code>@zetapush/platform</code> to import <code>Inject()</code>. This object will resolve the dependencies injection of <em>cloud services</em> and <em>custom cloud services</em>.</p>
</div>
<div class="listingblock">
<div class="title">Install @zetapush/platform</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ npm install --save @zetapush/platform</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The dependencies injection of ZetaPush use the library <strong>injection-js</strong>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, to import an other service, you simply need to write :</p>
</div>
<div class="listingblock highlight-lines:6-11,13">
<div class="title">Import service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre>const { Inject, Stack } = require(<span class="string"><span class="delimiter">'</span><span class="content">@zetapush/platform</span><span class="delimiter">'</span></span>); <i class="conum" data-value="1"></i><b>(1)</b>
const MyOtherService = require(<span class="string"><span class="delimiter">'</span><span class="content">./services.js</span><span class="delimiter">'</span></span>); <i class="conum" data-value="2"></i><b>(2)</b>

<span class="reserved">class</span> MyOwnService {

    <span class="reserved">static</span> get parameters() { <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="keyword">return</span> [
            <span class="keyword">new</span> Inject(MyOtherService),
            <span class="keyword">new</span> Inject(Stack)
        ]
    }

    constructor(myOtherService, stack) { <i class="conum" data-value="4"></i><b>(4)</b>
        ...
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We import the <code>Inject</code> object and a service (<em>Stack</em>) provided by ZetaPush</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We import an other custom cloud service</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a static method to implement our dependencies injection (<em>injection-js</em> syntax)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We use instances of our injected services in our service throught the constructor</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The order in your <code>parameters</code> method need to be the same in your constructor. (Here, first <em>MyOtherService</em>, then <em>Stack</em>)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you import a <em>custom cloud service</em> or a <em>cloud service</em> provided by ZetaPush, you use both similary</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_imported_cloud_services"><a class="anchor" href="#_use_imported_cloud_services"></a>Use imported cloud services</h4>
<div class="paragraph">
<p>Once you have import the services, you can use them.</p>
</div>
<div class="paragraph">
<p>In this example, we will use the <code>Stack</code> <em>cloud service</em> provided by ZetaPush.
In our use-case, we want to put some data associated with the current timestamp and be able to list all stored data.</p>
</div>
<div class="paragraph">
<p>For this the <code>Stack</code> service provides some methods :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>push({ <em>stack</em>: string, <em>data</em>: object });</p>
</li>
<li>
<p>list({ <em>stack</em>: string });</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>Stack</code> service has asynchronous methods
</td>
</tr>
</table>
</div>
<div class="listingblock highlight-lines:5-9,11,12,14">
<div class="title">MyStorageService</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td>
  <td class="code"><pre>const { Inject, Stack } = require(<span class="string"><span class="delimiter">'</span><span class="content">@zetapush/platform</span><span class="delimiter">'</span></span>);

<span class="reserved">class</span> MyStorageService {

    <span class="reserved">static</span> get parameters() {
        <span class="keyword">return</span> [
            <span class="keyword">new</span> Inject(Stack) <i class="conum" data-value="1"></i><b>(1)</b>
        ]
    }

    constructor(stack) { <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="local-variable">this</span>.stack = stack;
        <span class="local-variable">this</span>.stackName = <span class="string"><span class="delimiter">'</span><span class="content">stack-example</span><span class="delimiter">'</span></span>;
    }

    <span class="comment">/**
     *  Store data with associated timestamp
     *  @param {object} value Data we want to store
     */</span>
    async storeWithTimestamp(value) {
        <span class="keyword">return</span> <span class="local-variable">this</span>.stack.push({
            <span class="key">stack</span>: <span class="local-variable">this</span>.stackName,
            <span class="key">data</span>: {
                value,
                <span class="key">timestamp</span>: Date.now()
            }
        });
    }

    <span class="comment">/**
     * List all stored data
     */</span>
    async getAllData() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.stack.list({
            <span class="key">stack</span>: <span class="local-variable">this</span>.stackName
        });
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We import the <code>Stack</code> service</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>stack</code> is an instance of <code>Stack</code></td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_an_other_em_custom_cloud_service_em_in_my_own"><a class="anchor" href="#_use_an_other_em_custom_cloud_service_em_in_my_own"></a>Use an other <em>custom cloud service</em> in my own</h3>
<div class="sect3">
<h4 id="_dependencies_injection_2"><a class="anchor" href="#_dependencies_injection_2"></a>Dependencies injection</h4>
<div class="paragraph">
<p>First of all, if you want to include some services (custom or not), you need to use <em>dependencies injection</em> of ZetaPush. All of your dependencies injection will be facilitated.</p>
</div>
<div class="paragraph">
<p>So, you need to import the package <code>@zetapush/platform</code> to import <code>Inject()</code>. This object will resolve the dependencies injection of <em>cloud services</em> and <em>custom cloud services</em>.</p>
</div>
<div class="listingblock">
<div class="title">Install @zetapush/platform</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ npm install --save @zetapush/platform</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The dependencies injection of ZetaPush use the library <strong>injection-js</strong>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, to import an other service, you simply need to write :</p>
</div>
<div class="listingblock highlight-lines:6-11,13">
<div class="title">Import service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre>const { Inject, Stack } = require(<span class="string"><span class="delimiter">'</span><span class="content">@zetapush/platform</span><span class="delimiter">'</span></span>); <i class="conum" data-value="1"></i><b>(1)</b>
const MyOtherService = require(<span class="string"><span class="delimiter">'</span><span class="content">./services.js</span><span class="delimiter">'</span></span>); <i class="conum" data-value="2"></i><b>(2)</b>

<span class="reserved">class</span> MyOwnService {

    <span class="reserved">static</span> get parameters() { <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="keyword">return</span> [
            <span class="keyword">new</span> Inject(MyOtherService),
            <span class="keyword">new</span> Inject(Stack)
        ]
    }

    constructor(myOtherService, stack) { <i class="conum" data-value="4"></i><b>(4)</b>
        ...
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We import the <code>Inject</code> object and a service (<em>Stack</em>) provided by ZetaPush</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We import an other custom cloud service</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a static method to implement our dependencies injection (<em>injection-js</em> syntax)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We use instances of our injected services in our service throught the constructor</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The order in your <code>parameters</code> method need to be the same in your constructor. (Here, first <em>MyOtherService</em>, then <em>Stack</em>)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you import a <em>custom cloud service</em> or a <em>cloud service</em> provided by ZetaPush, you use both similary</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_imported_custom_cloud_services"><a class="anchor" href="#_use_imported_custom_cloud_services"></a>Use imported custom cloud services</h4>
<div class="paragraph">
<p>Once you have import the services, you can use them.</p>
</div>
<div class="paragraph">
<p>In this example, we will have 2 <em>custom cloud services</em> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Calendar</code> : Utils function to return the current date</p>
</li>
<li>
<p><code>HelloWorldService</code> : Basic example using <code>Calendar</code> <em>cloud function</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <em>custom cloud service</em> (<code>Calendar</code>) is in the file : "worker/calendar.js".</p>
</div>
<div class="listingblock">
<div class="title">worker/calendar.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> Calendar {
    getNow() { <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="keyword">return</span> <span class="keyword">new</span> Date().toLocalDateString(<span class="string"><span class="delimiter">'</span><span class="content">fr-FR</span><span class="delimiter">'</span></span>);
    }
}

module.exports = Calendar;</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The only <em>cloud function</em> of the <code>Calendar</code> service</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, we have the <code>HelloWorldService</code> that use our <code>Calendar</code> service. It is in the file : "./worker/index.js".</p>
</div>
<div class="listingblock highlight-lines:6-10,12-14">
<div class="title">worker/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td>
  <td class="code"><pre>const { Inject } = require(<span class="string"><span class="delimiter">'</span><span class="content">@zetapush/platform</span><span class="delimiter">'</span></span>);
const { Calendar } = require(<span class="string"><span class="delimiter">'</span><span class="content">./calendar.js</span><span class="delimiter">'</span></span>);

<span class="reserved">class</span> HelloWorldService {

    <span class="reserved">static</span> get parameters() {
        <span class="keyword">return</span> [
            <span class="keyword">new</span> Inject(Calendar) <i class="conum" data-value="1"></i><b>(1)</b>
        ]
    }

    constructor(calendar) { <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="local-variable">this</span>.calendar = calendar;
    }

    <span class="comment">/**
     *  Return 'Hello World' with current date
     */</span>
    helloWorldWithDate() {
        <span class="keyword">return</span> <span class="error">`</span>Hello world at <span class="predefined">$</span>{<span class="local-variable">this</span>.calendar.getNow()}<span class="error">`</span>;
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We import the <code>Calendar</code> service</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>calendar</code> is an instance of <code>Calendar</code></td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_expose_my_em_custom_cloud_services_em"><a class="anchor" href="#_expose_my_em_custom_cloud_services_em"></a>Expose my <em>custom cloud services</em></h3>
<div class="paragraph">
<p>When you create a <em>custom cloud service</em> that you want to expose to the client, you need to declare it. You have 2 cases :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Only one <em>custom cloud service</em> exposed</p>
</li>
<li>
<p>Many <em>custom cloud servcies</em> exposed</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>package.json</code> has a property named <code>main</code>. It defines the file where the <em>custom cloud services</em> are exposed. The following examples define them in <code>worker/index.js</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_only_one_custom_cloud_service_exposed"><a class="anchor" href="#_only_one_custom_cloud_service_exposed"></a>Only one custom cloud service exposed</h4>
<div class="paragraph">
<p>In this example, we have 2 <em>custom cloud services</em> : One is private and the second is exposed :</p>
</div>
<div class="listingblock highlight-lines:24">
<div class="title">worker/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td>
  <td class="code"><pre>const { Inject } = require(<span class="string"><span class="delimiter">'</span><span class="content">@zetapush/platform</span><span class="delimiter">'</span></span>);

<span class="reserved">class</span> Calendar { <i class="conum" data-value="1"></i><b>(1)</b>
  getNow() {
    <span class="keyword">return</span> <span class="keyword">new</span> Date().toLocaleDateString();
  }
}

<span class="reserved">class</span> MyPublicCustomCloudService { <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="reserved">static</span> get parameters() {
    <span class="keyword">return</span> [
      <span class="keyword">new</span> Inject(Calendar)
    ];
  }
  constructor(calendar) {
    <span class="local-variable">this</span>.calendar = calendar;
  }

  async hello() {
    <span class="keyword">return</span> <span class="error">`</span>Hello World at <span class="predefined">$</span>{<span class="local-variable">this</span>.calendar.getNow()}<span class="error">`</span>;
  }
}

module.exports = MyPublicCustomCloudService; <i class="conum" data-value="3"></i><b>(3)</b></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>Calendar</code> is my private <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>MyPublicCustomCloudService</code> is my exposed <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We expose only <code>MyPublicCustomCloudService</code> to the client side</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_many_custom_cloud_services_exposed"><a class="anchor" href="#_many_custom_cloud_services_exposed"></a>Many custom cloud services exposed</h4>
<div class="paragraph">
<p>In this example, we want to expose 2 <em>custom cloud services</em>. In this case, we need to specify the namespace of each <em>custom cloud service</em> :</p>
</div>
<div class="listingblock highlight-lines:24-27">
<div class="title">worker/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td>
  <td class="code"><pre>const { Inject } = require(<span class="string"><span class="delimiter">'</span><span class="content">@zetapush/platform</span><span class="delimiter">'</span></span>);

<span class="reserved">class</span> Calendar { <i class="conum" data-value="1"></i><b>(1)</b>
  getNow() {
    <span class="keyword">return</span> <span class="keyword">new</span> Date().toLocaleDateString();
  }
}

<span class="reserved">class</span> HelloService {
  <span class="reserved">static</span> get parameters() {
    <span class="keyword">return</span> [
      <span class="keyword">new</span> Inject(Calendar)
    ];
  }
  constructor(calendar) {
    <span class="local-variable">this</span>.calendar = calendar;
  }

  async hello() {
    <span class="keyword">return</span> <span class="error">`</span>Hello World at <span class="predefined">$</span>{<span class="local-variable">this</span>.calendar.getNow()}<span class="error">`</span>;
  }
}

module.exports = { <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="key">helloService</span>: HelloService,
  <span class="key">calendar</span>: Calendar
};</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>No need to define <code>parameters</code> static method because we don&#8217;t expose this service</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We expose the 2 <em>custom cloud services</em> to the client side with the syntax : { <em>namespace1</em> : <em>Service1</em>, <em>namespace2</em> : <em>Service2</em> }</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_complete_example"><a class="anchor" href="#_complete_example"></a>Complete example</h3>
<div class="paragraph">
<p>My configuration in the <code>package.json</code> is the following :</p>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myApp</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">worker/index.js</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">dependencies</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/core</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^0.18.2</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/plaform</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^0.18.2</span><span class="delimiter">&quot;</span></span>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>And my back side code is :</p>
</div>
<div class="listingblock">
<div class="title">worker/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td>
  <td class="code"><pre>const { Stack, Inject } = require(<span class="string"><span class="delimiter">'</span><span class="content">@zetapush/platform</span><span class="delimiter">'</span></span>)

<span class="reserved">class</span> DateCustomService {
    constructor() {}

    <i class="conum" data-value="1"></i><b>(1)</b>

    formatDate(date) {
        <span class="keyword">return</span> date.toLocalDateString(<span class="string"><span class="delimiter">&quot;</span><span class="content">fr-FR</span><span class="delimiter">&quot;</span></span>);
    }
}

<span class="reserved">class</span> SimpleStorageWithDate {

    <span class="reserved">static</span> get parameters() {
        <span class="keyword">return</span> [
            <span class="keyword">new</span> Inject(Stack),
            <span class="keyword">new</span> Inject(DateCustomService)
        ]
    }

    constructor(stack, dateCustomService) {
        <span class="local-variable">this</span>.stack = stack;
        <span class="local-variable">this</span>.dateCustomService = dateCustomService;
    }

    async push(item) { <i class="conum" data-value="2"></i><b>(2)</b>
        const output = await <span class="local-variable">this</span>.stack.push({ <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="key">stack</span>: <span class="string"><span class="delimiter">'</span><span class="content">test</span><span class="delimiter">'</span></span>,
            <span class="key">data</span>: {
                <span class="key">value</span>: item,
                <span class="key">date</span>: <span class="local-variable">this</span>.dateService.formateDate(<span class="keyword">new</span> Date()); <i class="conum" data-value="4"></i><b>(4)</b>
            }
        });
        <span class="keyword">return</span> const;
    }

    async list() {
        const output = await <span class="local-variable">this</span>.stack.list({ <span class="key">stack</span>: <span class="string"><span class="delimiter">'</span><span class="content">demo</span><span class="delimiter">'</span></span>});
        <span class="keyword">return</span> output;
    }
}

module.exports = SimpleStorageWithDate; <i class="conum" data-value="5"></i><b>(5)</b></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>No need to define <code>parameters</code> static method because we don&#8217;t expose this service</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Async/Await context</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Use the existing <em>cloud services</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use an other <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Expose only <code>SimpleStorageWithDate</code></td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_services"><a class="anchor" href="#_use_services"></a>Use services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On the front-side, you will want to use the <em>cloud services</em> provided by ZetaPush or your <em>custom cloud services</em>.
The utilization of a <em>cloud service</em> or a <em>custom cloud service</em> <strong>is exactly the same process</strong>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Currently, we can&#8217;t call a <em>cloud service</em> provided by ZetaPush from the front-end. This will be worked out very soon, and this will be the same syntax that the <em>custom cloud service</em>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_requirements"><a class="anchor" href="#_requirements"></a>Requirements</h3>
<div class="paragraph">
<p>To use services (custom or not), you need to have installed the dependency of the ZetaPush Core (<code>@zetapush/core</code>).</p>
</div>
<div class="paragraph">
<p>So you can install it with :</p>
</div>
<div class="listingblock">
<div class="title">Install @zetapush/core via npm</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ npm install @zetapush/core</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="title">Install @zetapush/core via unpkg</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">&lt;script src=&quot;https://unpkg.com/@zetapush/core&quot;&gt;&lt;/script&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_requirements_for_em_custom_cloud_service_em"><a class="anchor" href="#_requirements_for_em_custom_cloud_service_em"></a>Requirements for <em>custom cloud service</em></h4>
<div class="paragraph">
<p>If you want to use a <em>custom cloud service</em>, make sure that you have exposed your service (<a href="#_expose_my_em_custom_cloud_services_em">Documentation</a>)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_a_service"><a class="anchor" href="#_use_a_service"></a>Use a service</h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The utilization of a <em>custom cloud service</em> and a <em>cloud service</em> provided by ZetaPush is exactly the same process
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example gives a better explanation than a long speech, so here is an example of utilization of services.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When you call a <em>cloud function</em>, the result is always a Promise.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In our example we use this <em>custom cloud service</em> named <code>HelloService</code> :</p>
</div>
<div class="listingblock">
<div class="title">worker/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> HelloService {
    <span class="reserved">static</span> get parameters() {
        <span class="keyword">return</span> [];
    }
    constructor() { }

    async hello() {
        <span class="keyword">return</span> <span class="error">`</span>Hello World<span class="error">`</span>;
    }
}

module.exports = HelloService; <i class="conum" data-value="1"></i><b>(1)</b></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The service is exported</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now we create the HTML page with a button to display the <em>HelloWorld</em> message in the console :</p>
</div>
<div class="listingblock">
<div class="title">front/index.html</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
  <td class="code"><pre><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;head&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">charset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">viewport</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">width=device-width, initial-scale=1.0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;title&gt;</span>Celtia<span class="tag">&lt;/title&gt;</span>
<span class="tag">&lt;/head&gt;</span>

<span class="tag">&lt;body&gt;</span>
    <span class="tag">&lt;button</span> <span class="attribute-name">onclick</span>=<span class="string"><span class="delimiter">&quot;</span>hello()<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>hello<span class="tag">&lt;/button&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;ul&gt;</span><span class="tag">&lt;/ul&gt;</span>

    <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://unpkg.com/@zetapush/core</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">./index.js</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>

<span class="tag">&lt;/html&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We call <code>hello()</code> that call our <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Dependency of ZetaPush Core</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, we have the front-side code to call our services :</p>
</div>
<div class="listingblock">
<div class="title">front/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td>
  <td class="code"><pre><span class="comment">// Create new ZetaPush Client</span>
const client = <span class="keyword">new</span> ZetaPush.WeakClient({ <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="key">appName</span>: &lt;yourAppName&gt;,
    <span class="key">platformUrl</span>: &lt;optionalUrl&gt;
});

const api = client.createProxyTaskService(); <i class="conum" data-value="2"></i><b>(2)</b>

client.connect().then(() =&gt; ( <i class="conum" data-value="3"></i><b>(3)</b>
    console.debug(<span class="string"><span class="delimiter">'</span><span class="content">onConnectionEstablished</span><span class="delimiter">'</span></span>)
));

async <span class="keyword">function</span> <span class="function">hello</span>() {
    const output = await api.hello(); <i class="conum" data-value="4"></i><b>(4)</b>

    const ul = document.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">ul</span><span class="delimiter">'</span></span>);
    const fragment = document.createDocumentFragment();
    const li = document.createElement(<span class="string"><span class="delimiter">'</span><span class="content">li</span><span class="delimiter">'</span></span>);
    li.textContent = output;
    fragment.appendChild(li);
    ul.appendChild(fragment);
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the ZetaPush client with a specific appName and optional URL</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>API to access to our services</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Connection to the ZetaPush platform</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Call our <em>cloud function</em> and display the result</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Now when we click on the button, "Hello World" is displayed on the page.</strong></p>
</div>
<div class="sect3">
<h4 id="_namespace"><a class="anchor" href="#_namespace"></a>Namespace</h4>
<div class="paragraph">
<p>When you call a <em>cloud function</em> from a <em>custom cloud service</em>, you can specified a <em>namespace</em> (if you have 2 <em>cloud functions</em> on 2 differents <em>custom cloud services</em>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <em>namespace</em> is never used in the <em>custom cloud service</em>. The <em>namespace</em> is defined when you expose your <em>custom cloud service</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example we have this service :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> Api {
    constructor() {}

    hello(name, context) { <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="keyword">return</span> <span class="error">`</span>Hello <span class="predefined">$</span>{name} called by <span class="predefined">$</span>{context.owner}.<span class="error">`</span>;
    }
}

module.exports = {
    <span class="key">api</span>: Api <i class="conum" data-value="2"></i><b>(2)</b>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <em>namespace</em> is never passed here</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We export this <em>custom cloud service</em> with the namespace 'api'</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can call <code>hello()</code> like this :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
</pre></td>
  <td class="code"><pre><span class="comment">// api is an instance of Api</span>
<span class="local-variable">this</span>.api.hello(<span class="string"><span class="delimiter">'</span><span class="content">Toto</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">api</span><span class="delimiter">'</span></span>); <i class="conum" data-value="1"></i><b>(1)</b></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We use the method <code>hello()</code> from the namespace <em>api</em>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deployment"><a class="anchor" href="#_deployment"></a>Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you have develop your application and test it, you may want to deploy it.</p>
</div>
<div class="sect2">
<h3 id="_what_is_deployment"><a class="anchor" href="#_what_is_deployment"></a>What is deployment ?</h3>
<div class="paragraph">
<p>In the <em>deployment</em> with ZetaPush, you have 2 parts :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hosting and scalability of the back end</p>
</li>
<li>
<p>Hosting of the front end</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_back_end"><a class="anchor" href="#_back_end"></a>Back end</h4>
<div class="paragraph">
<p>When you deploy the back end part (<em>custom cloud services</em>) of your application, we take care of the hosting of your code. In addition, we manage the scability of your application.</p>
</div>
</div>
<div class="sect3">
<h4 id="_front_end"><a class="anchor" href="#_front_end"></a>Front end</h4>
<div class="paragraph">
<p>For the front end part, we hosting your application and return you an unique URL to access to your application. We also link your front end logic with the differents services you need (<em>custom cloud services</em> or <em>cloud services</em> provided by ZetaPush).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_requirements_2"><a class="anchor" href="#_requirements_2"></a>Requirements</h3>
<div class="paragraph">
<p>To execute or deploy your application you need to use the <em>Command Line Interface (CLI)</em>.</p>
</div>
<div class="paragraph">
<p>You can check if you already installed the CLI with :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta --version</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the CLI returns a result as <code>0.18.4</code>, the CLI is installed.</p>
</div>
<div class="paragraph">
<p>Otherwise, you can install it with :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm install -g @zetapush/cli</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_deploy_your_application"><a class="anchor" href="#_how_to_deploy_your_application"></a>How to deploy your application ?</h3>
<div class="paragraph">
<p>The deployment is very easy, to do this you only need to launch this command in your application directory :</p>
</div>
<div class="listingblock">
<div class="title">Deploy an application</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ cd myApp/
$ zeta push</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command will read the <code>.zetarc</code> file. If there is no <em>developerLogin</em> and <em>developerPassword</em> properties or if the ZetaPush account is not validated, you will not be able to push your application.</p>
</div>
<div class="paragraph">
<p>About the <em>appName</em> property, if it is empty, the CLI will deploy your code on a new application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When you deploy your application (Front + Worker), the CLI returns you an unique URL to use it.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_deploy_only_the_em_worker_em"><a class="anchor" href="#_how_to_deploy_only_the_em_worker_em"></a>How to deploy only the <em>worker</em> ?</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <em>Worker</em> is the back end of your application. Generally you put your business logic inside it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to only deploy your worker on the ZetaPush platform, you can launch :</p>
</div>
<div class="listingblock">
<div class="title">Deploy the worker</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ cd myApp/
$ zeta push --worker</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case you only deploy your back end code, so no URL will be return.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_management"><a class="anchor" href="#_configuration_management"></a>Configuration management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ZetaPush provides many variables to configure your applications.
There are 2 types : the <em>account configuration variables</em> and the <em>application configuration variables</em>.</p>
</div>
<div class="sect2">
<h3 id="_account_configuration"><a class="anchor" href="#_account_configuration"></a>Account configuration</h3>
<div class="paragraph">
<p>To use ZetaPush Celtia, you need to have an account and an optional application.
You specify this properties in the <code>.zetarc</code> file.
Here is the list of them :</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Account variables</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">Name of the property</th>
<th class="tableblock halign-center valign-middle">Definition</th>
<th class="tableblock halign-center valign-middle">environment variable</th>
<th class="tableblock halign-center valign-middle">Name in the <em>.zetarc</em></th>
<th class="tableblock halign-center valign-middle">CLI parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Developer login</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">This login is the email used by the developer to the connection on the ZetaPush console. It <strong>doesn&#8217;t concerns</strong> any application developed by the developer. It&#8217;s only used to identify the developer account.</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ZP_DEVELOPER_LOGIN</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">developerLogin</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">--developer-login &lt;login&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Developer password</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Like the property <em>--developer-login</em>, this password is only used for the ZetaPush developer account. It <strong>doesn&#8217;t concerns</strong> any application developed by the developer.</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ZP_DEVELOPER_PASSWORD</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">developerLogin</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">--developer-password &lt;password&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Developer login</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">A developer can develops many applications. So for his account on the ZetaPush platform, he need to identify each of them. The <em>appName</em> property is the unique name of an application on a ZetaPush developer account.</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ZP_APP_NAME</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">appName</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">--app-name &lt;name&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Environment name</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">An application created by a developer can takes many environments.
The default environment is <em>prod</em> but you can create your own (<em>dev</em>, <em>preprod</em>, &#8230;&#8203;).
An environment is one stage in the life-cycle of the application.</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ZP_ENV_NAME</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">envName</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">--env-name &lt;env&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Platform URL</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">By default, the developer use the <em>production environment of ZetaPush</em> to develop and deploy its applications. In most cases, the developer doesn&#8217;t need to set this property. <strong>He just need to use this property if ZetaPush says explicitly to use an other ZetaPush platform.</strong></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ZP_PLATFORM_URL</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">platformUrl</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">--platform-url &lt;platform&gt;</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_application_configuration"><a class="anchor" href="#_application_configuration"></a>Application configuration</h3>
<div class="paragraph">
<p>You can configure your applications with several variables. Here is the list of them :</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Application variables</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">Name of the property</th>
<th class="tableblock halign-center valign-middle">Definition</th>
<th class="tableblock halign-center valign-middle"><em>package.json</em></th>
<th class="tableblock halign-center valign-middle">CLI parameter</th>
<th class="tableblock halign-center valign-middle">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p>Front code</p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p>In an application, you need to define where you put your front end part of your application.
ZetaPush uses this property to host and expose it.</p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
</pre></td>
  <td class="code"><pre><span class="key"><span class="delimiter">&quot;</span><span class="content">zetapush</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">front</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">./path/of/front</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p>--front &lt;path&gt;</p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p><code>./front/</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p>Worker code</p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p>When you create your business logic in <em>custom cloud services</em>, ZetaPush need to know his location to deploy it.</p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
</pre></td>
  <td class="code"><pre><span class="key"><span class="delimiter">&quot;</span><span class="content">zetapush</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">worker</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">./path/of/worker</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p>--worker &lt;path&gt;</p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p><code>./worker/</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p>Worker entry point</p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p>To use your <em>custom cloud services</em> from the front part you need to export them. So the exportation of services need to be in only one file.</p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span class="key"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">./path/of/entry</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p><em>None</em></p>
</div></div></td>
<td class="tableblock halign-center valign-middle"><div><div class="paragraph">
<p><code>./worker/index.js</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_configuration_override"><a class="anchor" href="#_configuration_override"></a>Configuration override</h3>
<div class="paragraph">
<p>You can put many properties in several locations (environment variables, CLI&#8230;&#8203;).
ZetaPush includes and overrides this properties in a specific order :</p>
</div>
<div class="sect3">
<h4 id="_account_properties"><a class="anchor" href="#_account_properties"></a>Account properties</h4>
<div class="imageblock">
<div class="content">
<img src="override-account-properties.png" alt="override account properties" width="183" height="242">
</div>
</div>
<div class="paragraph">
<p>So if you use the same property in several locations, the environment variable is overwritten by the <code>.zetarc</code> value and this last value is overwritten by the CLI parameter.</p>
</div>
</div>
<div class="sect3">
<h4 id="_application_properties"><a class="anchor" href="#_application_properties"></a>Application properties</h4>
<div class="imageblock">
<div class="content">
<img src="override-application-properties.png" alt="override application properties" width="155" height="242">
</div>
</div>
<div class="paragraph">
<p>So if you use the same property in several locations, the default value is overwritten by the <code>package.json</code> value and this last value is overwritten by the CLI parameter.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-06-15 20:55:53 UTC
</div>
</div>
</body>
</html>