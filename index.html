<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<meta name="author" content="0.0.1-SNAPSHOT">
<title>ZetaPush documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src=".//javascripts/menu.js"></script>
<script type="text/javascript" src=".//javascripts/sidebar.js"></script>
<script type="text/javascript" src=".//javascripts/steps.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/source-utils.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/highlight-lines.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/collapse-lines.js"></script>
<script type="text/javascript" src=".//javascripts/tabcontainer.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css"
  /> -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,800" rel="stylesheet">
<link rel="stylesheet" type="text/css" href=".//styles/zetapush-styles.css" />
<link rel="stylesheet" type="text/css" href=".//styles/custom-styles.css" />
<link rel="stylesheet" type="text/css" href=".//styles/tabcontainer.css" />
<link rel="stylesheet" type="text/css" href=".//styles/steps.css" />
<link rel="stylesheet" type="text/css" href=".//styles/sourcecode/collapse-lines.css" />
<link rel="stylesheet" type="text/css" href=".//styles/sourcecode/highlight-lines.css" />
<header>
  <nav>
    <div class="main-title"><span></span><i class="fa fa-caret-down"></i></div>
    <ul>
      <li><a href="/documentation"><span>ZetaPush documentation</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/quick-start.html"><span>Quick start</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/developer-manual.html"><span>Developer manual</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/how-to.html"><span>How to guides</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/tutorials.html"><span>Tutorials</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/reference.html"><span>Reference</span><i class="fa fa-angle-right"></i></a></li>
    </ul>
    <div>
      <div class="contact-us">
        <a href="https://spectrum.chat/zetapush">Contact us</a>
      </div>
      <div class="github">
        <a href="https://github.com/zetapush">
          <span>Join us on</span><i class="fa fa-github-alt" title="Github"></i></a>
      </div>
      <div class="search"></div>
      <div class="logo">
        <a href="https://zetapush.com"><span class="icon"></span></a>
      </div>
    </div>
  </nav>
</header>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>ZetaPush documentation</h1>
<div class="details">
<span id="author" class="author">0.0.1-SNAPSHOT</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel1">
<li><a href="#_zetapush_celtia">1. ZetaPush Celtia</a></li>
<li><a href="#_sections">2. Sections</a></li>
<li><a href="#_contact_us">3. Contact us</a></li>
<li><a href="#_terms_and_concepts">4. Terms and concepts</a></li>
</ul>
</li>
<li><a href="#_quick_start">Quick Start</a>
<ul class="sectlevel1">
<li><a href="#_system_requirements">5. System requirements</a></li>
<li><a href="#_create_your_first_application">6. Create your first application</a>
<ul class="sectlevel2">
<li><a href="#_from_the_command_line">6.1. From the command line</a></li>
<li><a href="#_generated_project">6.2. Generated project</a></li>
</ul>
</li>
<li><a href="#_run_locally_your_first_project">7. Run locally your first project</a>
<ul class="sectlevel2">
<li><a href="#_from_your_terminal">7.1. From your terminal</a></li>
<li><a href="#_how_it_works">7.2. How it works</a></li>
</ul>
</li>
<li><a href="#_push_your_first_project_in_the_cloud">8. Push your first project in the Cloud</a>
<ul class="sectlevel2">
<li><a href="#_from_your_terminal_2">8.1. From your terminal</a></li>
<li><a href="#_how_it_works_2">8.2. How it works</a></li>
</ul>
</li>
<li><a href="#_what_s_next">9. What&#8217;s next</a></li>
</ul>
</li>
<li><a href="#_developer_manual">Developer manual</a>
<ul class="sectlevel1">
<li><a href="#_account_management">10. Account management</a>
<ul class="sectlevel2">
<li><a href="#_create_a_new_account_and_a_new_application">10.1. Create a new account and a new application</a>
<ul class="sectlevel3">
<li><a href="#_using_zetapush_main_site">10.1.1. Using ZetaPush main site</a></li>
<li><a href="#_using_zetapush_web_console">10.1.2. Using ZetaPush web Console</a></li>
<li><a href="#_using_your_terminal">10.1.3. Using your terminal</a></li>
</ul>
</li>
<li><a href="#_add_a_new_application_to_your_account">10.2. Add a new application to your account</a></li>
<li><a href="#_configure_your_project_to_use_existing_application">10.3. Configure your project to use existing application</a></li>
</ul>
</li>
<li><a href="#_develop_your_front_with_zetapush">11. Develop your front with ZetaPush</a>
<ul class="sectlevel2">
<li><a href="#_use_built_in_zetapush_cloud_services">11.1. Use built-in ZetaPush cloud services</a></li>
<li><a href="#_configure_adapt_zetapush_cloud_services">11.2. Configure/adapt ZetaPush cloud services</a></li>
<li><a href="#_run_your_front_locally">11.3. Run your front locally</a></li>
</ul>
</li>
<li><a href="#_develop_your_business_logic">12. Develop your business logic</a>
<ul class="sectlevel2">
<li><a href="#_define_a_custom_cloud_service">12.1. Define a custom cloud service</a></li>
<li><a href="#_use_a_custom_cloud_service_in_your_front">12.2. Use a custom cloud service in your front</a></li>
<li><a href="#_hot_reload">12.3. Hot reload</a></li>
</ul>
</li>
<li><a href="#_deploy_publish_your_application">13. Deploy/publish your application</a>
<ul class="sectlevel2">
<li><a href="#_applications_and_environments">13.1. Applications and environments</a></li>
<li><a href="#_deploy_both_front_and_custom_cloud_services_on_zetapush_cloud">13.2. Deploy both front and custom cloud services on ZetaPush Cloud</a></li>
<li><a href="#_deploy_your_front_on_zetapush_cloud">13.3. Deploy your front on ZetaPush Cloud</a></li>
<li><a href="#_deploy_your_custom_cloud_services_on_zetapush_cloud">13.4. Deploy your custom cloud services on ZetaPush Cloud</a></li>
</ul>
</li>
<li><a href="#_testing">14. Testing</a>
<ul class="sectlevel2">
<li><a href="#_unit_testing_your_front">14.1. Unit testing your front</a></li>
<li><a href="#_unit_testing_your_custom_cloud_services">14.2. Unit testing your custom cloud services</a></li>
<li><a href="#_integration_testing_your_front">14.3. Integration testing your front</a></li>
<li><a href="#_integration_testing_your_custom_cloud_services">14.4. Integration testing your custom cloud services</a></li>
<li><a href="#_functional_testing_end_to_end_testing">14.5. Functional testing / end-to-end testing</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_tutorials">Tutorials</a>
<ul class="sectlevel1">
<li><a href="#_use_case">15. Use case</a>
<ul class="sectlevel2">
<li><a href="#_initialize_your_application">15.1. Initialize your application</a></li>
<li><a href="#_create_your_business_logic">15.2. Create your business logic</a>
<ul class="sectlevel3">
<li><a href="#_import_em_cloud_services_em_and_define_constants">15.2.1. Import <em>cloud services</em> and define constants</a></li>
<li><a href="#_create_the_class_with_its_constructor">15.2.2. Create the class with its constructor</a></li>
<li><a href="#_create_the_chat">15.2.3. Create the chat</a></li>
<li><a href="#_add_user_in_the_conversation">15.2.4. Add user in the conversation</a></li>
<li><a href="#_send_a_message">15.2.5. Send a message</a></li>
<li><a href="#_get_all_messages">15.2.6. Get all messages</a></li>
<li><a href="#_export_our_class">15.2.7. Export our class</a></li>
</ul>
</li>
<li><a href="#_use_your_em_custom_cloud_services_em">15.3. Use your <em>custom cloud services</em></a>
<ul class="sectlevel3">
<li><a href="#_launch_the_worker_locally">15.3.1. Launch the worker locally</a></li>
<li><a href="#_interaction_with_worker">15.3.2. Interaction with worker</a></li>
<li><a href="#_test_you_application_locally">15.3.3. Test you application locally</a></li>
</ul>
</li>
<li><a href="#_deploy_your_application">15.4. Deploy your application</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_guides">Guides</a></li>
<li><a href="#_faq">FAQ</a></li>
<li><a href="#_reference">Reference</a>
<ul class="sectlevel1">
<li><a href="#_command_line_interface">16. Command Line Interface</a>
<ul class="sectlevel2">
<li><a href="#_initialize_an_application">16.1. Initialize an application</a></li>
</ul>
</li>
<li><a href="#_zetapush_cloud_services">17. ZetaPush Cloud Services</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="_introduction" class="sect0"><a class="anchor" href="#_introduction"></a><a class="link" href="#_introduction">Introduction</a></h1>
<div class="sect1">
<h2 id="_zetapush_celtia"><a class="anchor" href="#_zetapush_celtia"></a><a class="link" href="#_zetapush_celtia">1. ZetaPush Celtia</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO: Write presentation</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sections"><a class="anchor" href="#_sections"></a><a class="link" href="#_sections">2. Sections</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="#_quick_start">Quick Start</a><br>
If you want to start using ZetaPush quickly</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="#_tutorials">Tutorials</a><br>
If you want to learn how to use ZetaPush Celtia main features, you can begin here</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="#how-to.adoc">Guides</a><br>
If you want to go into some topics in depth</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="#developer-manual.adoc">Developer Manual</a><br>
If you want to cover completely each topic</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="#reference.adoc">Reference</a><br>
If you want to search for a particular piece of information</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_contact_us"><a class="anchor" href="#_contact_us"></a><a class="link" href="#_contact_us">3. Contact us</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can contact us on <a href="https://spectrum.chat/zetapush" target="_blank">Spectrum</a>.</p>
</div>
<div class="paragraph">
<p>If you want to share your ideas with us, you can contribute to our <a href="https://github.com/zetapush/zetapush-next-open-specification" target="_blank">open specifications on GitHub</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_terms_and_concepts"><a class="anchor" href="#_terms_and_concepts"></a><a class="link" href="#_terms_and_concepts">4. Terms and concepts</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Word</th>
<th class="tableblock halign-left valign-middle">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ZetaPush Account</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Developer account on the ZetaPush platform to create and manage applications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Credentials</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Login/Password pair of the developer ZetaPush account</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Cloud function</p></td>
<td class="tableblock halign-left valign-middle"><div><div class="paragraph">
<p>A single operation that has a name, well-defined behavior, that can accept parameters and can produce an output.</p>
</div>
<div class="paragraph">
<p>This is equivalent to function in any language except that it is run remotely.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Cloud service</p></td>
<td class="tableblock halign-left valign-middle"><div><div class="paragraph">
<p>Several Cloud functions that are grouped together to cover a coherent set of features. You can consider this as a class (custom cloud service) with methods (cloud functions).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>ZetaPush already provides ready to use cloud services.
For example we have: Chat, Group, Messaging&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>In this documentation, we mention Cloud Services as a shortcut of ZetaPush Cloud Services.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Custom Cloud Service</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">A set of features like ZetaPush Cloud Services developed by you. The usage of your custom cloud services is exactly the same as ZetaPush cloud services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Front</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Web pages developed by you (HTML / CSS / JS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Worker</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Set of Custom cloud services that you have developed to mutualize your business logic.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Organization</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Group of ZetaPush accounts. Each organization may have several managers and several developers. Each person uses his own credentials
to interact with ZetaPush but actions are shared among the organization</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Application</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Logic container designed to perform a group of coordinated functions, tasks, or activities for the benefit of the user.
</p><p class="tableblock">An application may have a front part and a worker.
</p><p class="tableblock">An application has at least one environment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Environment</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Your application may be deployed and executed in separated zones called Environment. Each environment is a particular zone that you can organize as you wish.
For example, you can have <code>prod</code>, <code>pre-prod</code>, <code>dev</code> environments for the same application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">CLI</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Command Line Interface : utility scripts that are usable in a terminal to run your code or deploy your application for example</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Console</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Main website used to manage your ZetaPush account and applications, read the documentation, monitor your applications&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h1 id="_quick_start" class="sect0"><a class="anchor" href="#_quick_start"></a><a class="link" href="#_quick_start">Quick Start</a></h1>
<div class="sect1">
<h2 id="_system_requirements"><a class="anchor" href="#_system_requirements"></a><a class="link" href="#_system_requirements">5. System requirements</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>To create an application with ZetaPush you only need the NodeJS ecosystem:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>NodeJS version 8.11.2 (LTS) or higher</p>
</li>
<li>
<p>Npm version 5.x or higher</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>NodeJS is used for ZetaPush to:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>create custom cloud services</p>
</li>
<li>
<p>locally run custom cloud services</p>
</li>
<li>
<p>deploy your application on ZetaPush</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Install NodeJS and npm</strong></p>
</div>
<div class="paragraph">
<p>Go to <a href="https://nodejs.org/en/download/" target="_blank">NodeJS Downloads</a> and follow installation instructions.</p>
</div>
<div class="paragraph">
<p>You also need to install additionnal tools for NodeJS:</p>
</div>
<div class="paragraph tab-container">
<p>Additional tools</p>
</div>
<div class="paragraph tab">
<p>Windows</p>
</div>
<div class="paragraph">
<p>You must install development tools on Windows (Visual Studio Build Tools and Python).
Hopefully, there is a npm tool that helps you to install all required dependencies.
You must run this command line using <strong>PowerShell</strong> as <strong>Administrator</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">npm install --global --production windows-build-tools</code></pre>
</div>
</div>
<div class="paragraph">
<p>Be patient! It may take a while.</p>
</div>
<div class="paragraph tab">
<p>Debian/Ubuntu</p>
</div>
<div class="paragraph">
<p>Install build tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">sudo apt-get install -y build-essential</code></pre>
</div>
</div>
<div class="paragraph tab">
<p>Enterprise Linux and Fedora</p>
</div>
<div class="paragraph">
<p>Install build tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">sudo yum install gcc-c++ make
# or: sudo yum groupinstall 'Development Tools'</code></pre>
</div>
</div>
<div class="paragraph tab-container-end">
<p>-</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_your_first_application"><a class="anchor" href="#_create_your_first_application"></a><a class="link" href="#_create_your_first_application">6. Create your first application</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_from_the_command_line"><a class="anchor" href="#_from_the_command_line"></a><a class="link" href="#_from_the_command_line">6.1. From the command line</a></h3>
<div class="listingblock">
<div class="title">Generate application</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm init @zetapush first-hello-world <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><em>first-hello-world</em> is the name of the folder that will be created and will contain all generated files</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Using npm lower than 6</strong></p>
</div>
<div class="paragraph">
<p><code>npm</code> provides <code>npm init</code> command since version 6.</p>
</div>
<div class="paragraph">
<p>You can either upgrade your npm version or use npx utility.</p>
</div>
<div class="paragraph tab-container">
<p>npm 5-</p>
</div>
<div class="paragraph tab">
<p>Upgrade npm</p>
</div>
<div class="listingblock">
<div class="title">Upgrade npm</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm install -g npm@latest</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Use npm init</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm init @zetapush first-hello-world</code></pre>
</div>
</div>
<div class="paragraph tab">
<p>Use <em>npx</em> to launch the script</p>
</div>
<div class="listingblock">
<div class="title">Launch with npx</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npx @zetapush/create first-hello-world</code></pre>
</div>
</div>
<div class="paragraph tab-container-end">
<p>-</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>See <a href="#_account_management">Account management</a> to learn how to manage your account and your applications.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_generated_project"><a class="anchor" href="#_generated_project"></a><a class="link" href="#_generated_project">6.2. Generated project</a></h3>
<div class="imageblock center">
<div class="content">
<img src="./images//hello-world/result.png" alt="result">
</div>
<div class="title">Figure 1. Result of first-hello-world project</div>
</div>
<div class="paragraph">
<p>The generated project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provides a web page (front part)</p>
</li>
<li>
<p>The web page automatically connects to ZetaPush Cloud.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The connection is done by <code>client.connect()</code> in <code>first-hello-world/front/index.html</code>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>The web page displays a button named <code>hello()</code>.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <code>first-hello-world/front/index.html</code>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Provides a custom cloud service that generates a message ("hello world from JavaScript" followed by the date as timestamp).</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The executed code is available in <code>first-hello-world/worker/index.js</code>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>When the <code>hello()</code> button is clicked, the custom cloud service is called and the response is displayed in the browser console. The text of the button is also updated with the count of custom cloud services responses.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See call to <code>api.hello()</code> in <code>first-hello-world/front/index.js</code>.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The generated project files are:</p>
</div>
<div class="listingblock">
<div class="title">Generated tree structure</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">{appName}
├── .zetarc
├── .gitignore
├── front
│   ├── index.html
│   └── index.js
├── worker
│   └── index.js
├── README.md
└── package.json</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Definition of generated files</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">File / Folder</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.zetarc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the developer&#8217;s credentials. Useful to deploy or run your code. This content is auto generated if the file is empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.gitignore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prevents publication of your developer credentials (on GitHub for example)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.json</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the dependencies, the name of your application, the entry point of yours <em>custom cloud services</em> (<code>main</code> property) and many useful other informations for your application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>README.md</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Give you some informations about how to use your application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>front/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By convention, the front end code of your application is in this folder. You can change it by editing <code>package.json</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>worker/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By convention, the back end code of your application is in this folder. You can change it by editing <code>package.json</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_run_locally_your_first_project"><a class="anchor" href="#_run_locally_your_first_project"></a><a class="link" href="#_run_locally_your_first_project">7. Run locally your first project</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_from_your_terminal"><a class="anchor" href="#_from_your_terminal"></a><a class="link" href="#_from_your_terminal">7.1. From your terminal</a></h3>
<div class="listingblock">
<div class="title">Start application (front and custom cloud services)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run start -- --serve-front</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>npm run start</code> is a script alias defined in the <code>package.json</code> file.
The executed command under the hood is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta run --serve-front</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This command launchs a local web server on <code>localhost:3000</code> and also launchs the custom cloud services.
You can open a web browser on <code>localhost:3000</code> and open the browser console.</p>
</div>
<div class="paragraph">
<p>You can click on the button and see the result of the custom cloud service call in the browser console.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_it_works"><a class="anchor" href="#_how_it_works"></a><a class="link" href="#_how_it_works">7.2. How it works</a></h3>
<div class="imageblock center">
<div class="content">
<img src="./images//schemas/run-locally.png" alt="run locally">
</div>
<div class="title">Figure 2. Exchanges between web page and custom cloud services</div>
</div>
<div class="paragraph">
<p><span class="exchange-call">➊</span> Clicking on the button triggers a call to ZetaPush cloud. ZetaPush routes the call to the local NodeJS (the NodeJS has been registered automatically by the CLI)<br>
<span class="exchange-response">➋</span> The custom cloud service does its job and provides a response. ZetaPush routes the response to the connected web page</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_push_your_first_project_in_the_cloud"><a class="anchor" href="#_push_your_first_project_in_the_cloud"></a><a class="link" href="#_push_your_first_project_in_the_cloud">8. Push your first project in the Cloud</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_from_your_terminal_2"><a class="anchor" href="#_from_your_terminal_2"></a><a class="link" href="#_from_your_terminal_2">8.1. From your terminal</a></h3>
<div class="listingblock">
<div class="title">Deploy application (front and custom cloud services)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run deploy</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>npm run deploy</code> is a script alias defined in the <code>package.json</code> file.
The executed command under the hood is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta push</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This command uploads your code (front and worker) to ZetaPush cloud. ZetaPush then handles the deployment
by publishing your front and your custom cloud services.</p>
</div>
<div class="paragraph">
<p>The CLI displays the URL to access the published web page.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_it_works_2"><a class="anchor" href="#_how_it_works_2"></a><a class="link" href="#_how_it_works_2">8.2. How it works</a></h3>
<div class="imageblock center">
<div class="content">
<img src="./images//schemas/run-in-cloud.png" alt="run in cloud">
</div>
<div class="title">Figure 3. Exchanges between web page and custom cloud services</div>
</div>
<div class="paragraph">
<p><span class="exchange-call">➊</span> Clicking on the button triggers a call to ZetaPush cloud that routes directly the call to the hosted NodeJS<br>
<span class="exchange-response">➋</span> The custom cloud service does its job and provides a response that ZetaPush routes the response to the hosted web page</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_s_next"><a class="anchor" href="#_what_s_next"></a><a class="link" href="#_what_s_next">9. What&#8217;s next</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have created a new application, executed it locally and then published it.</p>
</div>
<div class="paragraph">
<p>Now, you are ready to code your own application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#_develop_front">how to use built-in ZetaPush cloud services</a></p>
</li>
<li>
<p>See <a href="#_develop_custom_could_services">how to develop your custom cloud services</a></p>
</li>
</ul>
</div>
</div>
</div>
<h1 id="_developer_manual" class="sect0"><a class="anchor" href="#_developer_manual"></a><a class="link" href="#_developer_manual">Developer manual</a></h1>
<div class="sect1">
<h2 id="_account_management"><a class="anchor" href="#_account_management"></a><a class="link" href="#_account_management">10. Account management</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each account</p>
</div>
<div class="sect2">
<h3 id="_create_a_new_account_and_a_new_application"><a class="anchor" href="#_create_a_new_account_and_a_new_application"></a><a class="link" href="#_create_a_new_account_and_a_new_application">10.1. Create a new account and a new application</a></h3>
<div class="sect3">
<h4 id="_using_zetapush_main_site"><a class="anchor" href="#_using_zetapush_main_site"></a><a class="link" href="#_using_zetapush_main_site">10.1.1. Using ZetaPush main site</a></h4>

</div>
<div class="sect3">
<h4 id="_using_zetapush_web_console"><a class="anchor" href="#_using_zetapush_web_console"></a><a class="link" href="#_using_zetapush_web_console">10.1.2. Using ZetaPush web Console</a></h4>

</div>
<div class="sect3">
<h4 id="_using_your_terminal"><a class="anchor" href="#_using_your_terminal"></a><a class="link" href="#_using_your_terminal">10.1.3. Using your terminal</a></h4>

</div>
</div>
<div class="sect2">
<h3 id="_add_a_new_application_to_your_account"><a class="anchor" href="#_add_a_new_application_to_your_account"></a><a class="link" href="#_add_a_new_application_to_your_account">10.2. Add a new application to your account</a></h3>

</div>
<div class="sect2">
<h3 id="_configure_your_project_to_use_existing_application"><a class="anchor" href="#_configure_your_project_to_use_existing_application"></a><a class="link" href="#_configure_your_project_to_use_existing_application">10.3. Configure your project to use existing application</a></h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_develop_your_front_with_zetapush"><a class="anchor" href="#_develop_your_front_with_zetapush"></a><a class="link" href="#_develop_your_front_with_zetapush">11. Develop your front with ZetaPush</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_use_built_in_zetapush_cloud_services"><a class="anchor" href="#_use_built_in_zetapush_cloud_services"></a><a class="link" href="#_use_built_in_zetapush_cloud_services">11.1. Use built-in ZetaPush cloud services</a></h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">

</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_configure_adapt_zetapush_cloud_services"><a class="anchor" href="#_configure_adapt_zetapush_cloud_services"></a><a class="link" href="#_configure_adapt_zetapush_cloud_services">11.2. Configure/adapt ZetaPush cloud services</a></h3>

</div>
<div class="sect2">
<h3 id="_run_your_front_locally"><a class="anchor" href="#_run_your_front_locally"></a><a class="link" href="#_run_your_front_locally">11.3. Run your front locally</a></h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_develop_your_business_logic"><a class="anchor" href="#_develop_your_business_logic"></a><a class="link" href="#_develop_your_business_logic">12. Develop your business logic</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_define_a_custom_cloud_service"><a class="anchor" href="#_define_a_custom_cloud_service"></a><a class="link" href="#_define_a_custom_cloud_service">12.1. Define a custom cloud service</a></h3>

</div>
<div class="sect2">
<h3 id="_use_a_custom_cloud_service_in_your_front"><a class="anchor" href="#_use_a_custom_cloud_service_in_your_front"></a><a class="link" href="#_use_a_custom_cloud_service_in_your_front">12.2. Use a custom cloud service in your front</a></h3>

</div>
<div class="sect2">
<h3 id="_hot_reload"><a class="anchor" href="#_hot_reload"></a><a class="link" href="#_hot_reload">12.3. Hot reload</a></h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploy_publish_your_application"><a class="anchor" href="#_deploy_publish_your_application"></a><a class="link" href="#_deploy_publish_your_application">13. Deploy/publish your application</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_applications_and_environments"><a class="anchor" href="#_applications_and_environments"></a><a class="link" href="#_applications_and_environments">13.1. Applications and environments</a></h3>

</div>
<div class="sect2">
<h3 id="_deploy_both_front_and_custom_cloud_services_on_zetapush_cloud"><a class="anchor" href="#_deploy_both_front_and_custom_cloud_services_on_zetapush_cloud"></a><a class="link" href="#_deploy_both_front_and_custom_cloud_services_on_zetapush_cloud">13.2. Deploy both front and custom cloud services on ZetaPush Cloud</a></h3>

</div>
<div class="sect2">
<h3 id="_deploy_your_front_on_zetapush_cloud"><a class="anchor" href="#_deploy_your_front_on_zetapush_cloud"></a><a class="link" href="#_deploy_your_front_on_zetapush_cloud">13.3. Deploy your front on ZetaPush Cloud</a></h3>

</div>
<div class="sect2">
<h3 id="_deploy_your_custom_cloud_services_on_zetapush_cloud"><a class="anchor" href="#_deploy_your_custom_cloud_services_on_zetapush_cloud"></a><a class="link" href="#_deploy_your_custom_cloud_services_on_zetapush_cloud">13.4. Deploy your custom cloud services on ZetaPush Cloud</a></h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing"><a class="anchor" href="#_testing"></a><a class="link" href="#_testing">14. Testing</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_unit_testing_your_front"><a class="anchor" href="#_unit_testing_your_front"></a><a class="link" href="#_unit_testing_your_front">14.1. Unit testing your front</a></h3>

</div>
<div class="sect2">
<h3 id="_unit_testing_your_custom_cloud_services"><a class="anchor" href="#_unit_testing_your_custom_cloud_services"></a><a class="link" href="#_unit_testing_your_custom_cloud_services">14.2. Unit testing your custom cloud services</a></h3>

</div>
<div class="sect2">
<h3 id="_integration_testing_your_front"><a class="anchor" href="#_integration_testing_your_front"></a><a class="link" href="#_integration_testing_your_front">14.3. Integration testing your front</a></h3>

</div>
<div class="sect2">
<h3 id="_integration_testing_your_custom_cloud_services"><a class="anchor" href="#_integration_testing_your_custom_cloud_services"></a><a class="link" href="#_integration_testing_your_custom_cloud_services">14.4. Integration testing your custom cloud services</a></h3>

</div>
<div class="sect2">
<h3 id="_functional_testing_end_to_end_testing"><a class="anchor" href="#_functional_testing_end_to_end_testing"></a><a class="link" href="#_functional_testing_end_to_end_testing">14.5. Functional testing / end-to-end testing</a></h3>

</div>
</div>
</div>
<h1 id="_tutorials" class="sect0"><a class="anchor" href="#_tutorials"></a><a class="link" href="#_tutorials">Tutorials</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>In this tutorial, you will create an application with ZetaPush, from the initialization to the deployment.
You will learn to :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add business logic with ZetaPush</p>
</li>
<li>
<p>Use <em>cloud services</em> provided by ZetaPush</p>
</li>
<li>
<p>Run your code locally</p>
</li>
<li>
<p>Deploy your application</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case"><a class="anchor" href="#_use_case"></a><a class="link" href="#_use_case">15. Use case</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will create a realtime chat application, but it will be particular : This will be an <strong>Avengers Chat</strong> !</p>
</div>
<div class="paragraph">
<p>At the beginning, the user of the chat can choose an Avenger. Each character has many skills and they can use them on the chat to attack the others Avengers.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. List of skills by Avenger</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">Avenger</th>
<th class="tableblock halign-center valign-middle">Skill</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Captain America</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Shoot of shield / Cure</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Falcon</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Archery / Super vision</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Iron Man</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Flight / Missile launcher</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Hulk</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Punch / Regeneration</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Thor</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Hammer hit / Lightning strike</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Spider Man</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Shoot of cobweb / Jump with cobweb</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Wolverine</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Scratch / Regeneration</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You will create this application in few steps :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#_initialize_your_application">Initialize a new application</a></p>
</li>
<li>
<p><a href="#_create_your_business_logic">Create the business logic in a <em>custom cloud service</em></a></p>
</li>
<li>
<p><a href="#_use_your_em_custom_cloud_services_em">Use your <em>custom cloud service</em> in your UI</a></p>
</li>
<li>
<p><a href="#_deploy_your_application">Deploy your application</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_initialize_your_application"><a class="anchor" href="#_initialize_your_application"></a><a class="link" href="#_initialize_your_application">15.1. Initialize your application</a></h3>
<div class="paragraph">
<p>In the first step, you need to create your application. To do this you can run :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>npm init @zetapush myApp --developer-login user@gmail.com --developer-password password</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will create you an account on the ZetaPush platform and create your first application in the <em>myApp</em> directory.
The create of an account send an email to confirm your account.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To use your application, you need to validate your account. To do this, click on the link in the received email
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this tutorial, we are focusing on the ZetaPush development. So to begin, get all resources and add them to your application (css, assets, &#8230;&#8203;) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>$ cd myApp/front/
$ rm -r ./*
$ curl -X GET 'http://github-download-subfolder.zpush.io/?owner=zetapush&amp;repository=zetapush-tutorials&amp;path=avengersChat/front' --output front.zip
$ unzip front.zip
$ rm front.zip
</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are using <em>Windows</em>, you can download the file with all resources and unzip it in the front directory. Link : <a href="http://github-download-subfolder.zpush.io/?owner=zetapush&amp;repository=zetapush-tutorials&amp;path=avengersChat/front" class="bare">http://github-download-subfolder.zpush.io/?owner=zetapush&amp;repository=zetapush-tutorials&amp;path=avengersChat/front</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So you already have the style and the frontend logic in the folders <code>assets</code> and <code>utils</code>. You can browse this files to understand this code.</p>
</div>
<div class="paragraph">
<p>In this tutorial, you need to :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the business logic with a <em>custom cloud service</em></p>
</li>
<li>
<p>Implement the interaction with the <em>custom cloud service</em> (front side)</p>
</li>
<li>
<p>Deploy your application</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_create_your_business_logic"><a class="anchor" href="#_create_your_business_logic"></a><a class="link" href="#_create_your_business_logic">15.2. Create your business logic</a></h3>
<div class="paragraph">
<p>Now, you will create the business logic of your application. To do this, you will use a <em>custom cloud service</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A <em>custom cloud service</em> is a class where you develop a business logic. You can create several <em>custom cloud services</em> inside one application. Each <em>custom cloud service</em> can use the <em>cloud services</em> provided by ZetaPush.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In your existing application you already have a <em>custom cloud service</em> on the file <code>worker/index.js</code> (Defined in the <code>package.json</code> with the property <code>main</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When you create one or many <em>custom cloud services</em>, you need to export them (to use them from the front side). The exportation need to be done in a file of your application, defined in the <code>package.json</code>. The property <code>main</code> defines this file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can fill this file (<code>worker/index.js</code>) with the following content :</p>
</div>
<div class="sect3">
<h4 id="_import_em_cloud_services_em_and_define_constants"><a class="anchor" href="#_import_em_cloud_services_em_and_define_constants"></a><a class="link" href="#_import_em_cloud_services_em_and_define_constants">15.2.1. Import <em>cloud services</em> and define constants</a></h4>
<div class="paragraph">
<p>First, you need to import the <em>cloud services</em> provided by ZetaPush, used in this application :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Stack</em> (Save data in a stack)</p>
</li>
<li>
<p><em>Messaging</em> (Send and receive messages)</p>
</li>
<li>
<p><em>GroupManagement</em> (Manage group of users)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You also need to import <em>Inject</em> that is useful for the dependencies injection.</p>
</div>
<div class="listingblock">
<div class="title">Imports and constants</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre>const { Stack, Messaging, GroupManagement, Inject } = require(<span class="string"><span class="delimiter">'</span><span class="content">@zetapush/platform</span><span class="delimiter">'</span></span>);

const CONVERSATION_ID = <span class="string"><span class="delimiter">'</span><span class="content">avengersChat</span><span class="delimiter">'</span></span>;
const CHANNEL_MESSAGING = <span class="string"><span class="delimiter">'</span><span class="content">avengersChannel</span><span class="delimiter">'</span></span>; <i class="conum" data-value="1"></i><b>(1)</b></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>On which channel the users send and listen the messages</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_create_the_class_with_its_constructor"><a class="anchor" href="#_create_the_class_with_its_constructor"></a><a class="link" href="#_create_the_class_with_its_constructor">15.2.2. Create the class with its constructor</a></h4>
<div class="paragraph">
<p>A <em>custom cloud service</em> is a class, so you need to create it.</p>
</div>
<div class="listingblock">
<div class="title">Class and constructor</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> AvengersApi {
  <span class="comment">/**
   * Dependencies injection of cloud services
   */</span>
  <span class="reserved">static</span> get parameters() { <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="keyword">return</span> [
      <span class="keyword">new</span> Inject(Stack),
      <span class="keyword">new</span> Inject(Messaging),
      <span class="keyword">new</span> Inject(GroupManagement)
    ]
  }

  <span class="comment">/**
   * Constructor of our API
   */</span>
  constructor(stack, messaging, groups) { <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="local-variable">this</span>.stack = stack;
    <span class="local-variable">this</span>.messaging = messaging;
    <span class="local-variable">this</span>.groups = groups;
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Syntax of dependencies injection based on <code>injection-js</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>You need to put the injected <em>cloud services</em> in the constructor in the same order that they are defined in the static method <code>parameters</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The dependencies injection of ZetaPush use <code>injection-js</code>. So we use the same syntax (static method <em>parameters</em>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_create_the_chat"><a class="anchor" href="#_create_the_chat"></a><a class="link" href="#_create_the_chat">15.2.3. Create the chat</a></h4>
<div class="paragraph">
<p>To create our chat, we use the <em>GroupManagement cloud service</em> provided by ZetaPush. The created group includes all users of the conversation.
So we add a method in our class to create this conversation.</p>
</div>
<div class="listingblock">
<div class="title">Create conversation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
  <td class="code"><pre><span class="comment">/**
 * Create the conversation of the chat, if doesn't already exists
 */</span>
async createConversation() {
    const { exists } = await <span class="local-variable">this</span>.groups.exists({
        <span class="key">group</span>: CONVERSATION_ID
    });
    <span class="keyword">if</span> (!exists) {
        await <span class="local-variable">this</span>.groups.createGroup({
            <span class="key">group</span>: CONVERSATION_ID
        });
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_user_in_the_conversation"><a class="anchor" href="#_add_user_in_the_conversation"></a><a class="link" href="#_add_user_in_the_conversation">15.2.4. Add user in the conversation</a></h4>
<div class="paragraph">
<p>When an user come to the chat, we need to add it to the conversation.
So we create a method in our class to add the current user in the conversation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td>
  <td class="code"><pre><span class="comment">/**
* Add the current user in the conversation
*/</span>
async addMeToConversation(parameters, context) { <i class="conum" data-value="1"></i><b>(1)</b>
    const output = await <span class="local-variable">this</span>.groups.addUser({
        <span class="key">group</span>: CONVERSATION_ID,
        <span class="key">user</span>: context.owner <i class="conum" data-value="2"></i><b>(2)</b>
    });
    <span class="keyword">return</span> output;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Each <em>cloud function</em> in a <em>custom cloud function</em> takes only one parameter. The second is the context, injected by the SDK</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We get the caller (owner) of the <em>cloud function</em> from the context.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_send_a_message"><a class="anchor" href="#_send_a_message"></a><a class="link" href="#_send_a_message">15.2.5. Send a message</a></h4>
<div class="paragraph">
<p>No we want to send a message on our chat. To do this, we need to follow 3 steps :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get all users in the conversation</p>
</li>
<li>
<p>Send the message of all users in the conversation</p>
</li>
<li>
<p>Store the message in a stack</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td>
  <td class="code"><pre><span class="comment">/**
* Send a message on the chat
* @param {Object} message
*/</span>
async sendMessage(message = {}) {
    <span class="comment">// Get all users inside the conversation</span>
    const group = await <span class="local-variable">this</span>.groups.groupUsers({
      <span class="key">group</span>: CONVERSATION_ID
    });
    const users = group.users;

    <span class="comment">// Send the message to each user in the conversation</span>
    <span class="local-variable">this</span>.messaging.send({
      <span class="key">target</span>: users,
      <span class="key">channel</span>: CHANNEL_MESSAGING,
      <span class="key">data</span>: { message }
    });

    <span class="comment">// Store the message in a stack</span>
    await <span class="local-variable">this</span>.stack.push({
      <span class="key">stack</span>: CONVERSATION_ID,
      <span class="key">data</span>: message
    });

    <span class="keyword">return</span> group;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
There is no specific method to launch an attack, to do this, we only send a specific message throught <code>sendMessage</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_get_all_messages"><a class="anchor" href="#_get_all_messages"></a><a class="link" href="#_get_all_messages">15.2.6. Get all messages</a></h4>
<div class="paragraph">
<p>To complete our business logic, we need to have an other method in our class to get all messages (when we enter in the chat).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre><span class="comment">/**
* Get all messages in the conversation
*/</span>
async getMessages() {
    const { result } = await <span class="local-variable">this</span>.stack.list({
      <span class="key">stack</span>: CONVERSATION_ID
    });
    <span class="keyword">return</span> result;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_export_our_class"><a class="anchor" href="#_export_our_class"></a><a class="link" href="#_export_our_class">15.2.7. Export our class</a></h4>
<div class="paragraph">
<p>At the end, we need to export our class to use it from the front side. To do this, we only need to add this line at the end of our file :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>module.exports = AvengersApi;</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now your <em>custom cloud service</em> is ready !</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_your_em_custom_cloud_services_em"><a class="anchor" href="#_use_your_em_custom_cloud_services_em"></a><a class="link" href="#_use_your_em_custom_cloud_services_em">15.3. Use your <em>custom cloud services</em></a></h3>
<div class="paragraph">
<p>Once we have our <em>custom cloud service</em>, we need to create the frontend of our application.</p>
</div>
<div class="sect3">
<h4 id="_launch_the_worker_locally"><a class="anchor" href="#_launch_the_worker_locally"></a><a class="link" href="#_launch_the_worker_locally">15.3.1. Launch the worker locally</a></h4>
<div class="paragraph">
<p>When we working on the frontend part, we often want to test our interaction with the backend logic.
So with ZetaPush, you can launch your worker locally to test this interaction.
To do this you need to use the <em>CLI</em> and run : <code>zeta run</code>.
But in this project, the <em>CLI</em> is imported and a script is created with npm, so you just need to launch :</p>
</div>
<div class="listingblock">
<div class="title">Run worker locally</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="predefined">$</span> npm run start</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to install the <em>ZetaPush CLI</em> you can run <code>npm install -g @zetapush/cli</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_interaction_with_worker"><a class="anchor" href="#_interaction_with_worker"></a><a class="link" href="#_interaction_with_worker">15.3.2. Interaction with worker</a></h4>
<div class="paragraph">
<p>Now you just need to add the interaction with the <em>custom cloud service</em>. To do this, fill the file <code>front/index.js</code> :</p>
</div>
<div class="listingblock">
<div class="title">Interaction with worker</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> AvengersController from <span class="string"><span class="delimiter">'</span><span class="content">./utils/controller.js</span><span class="delimiter">'</span></span>; <i class="conum" data-value="1"></i><b>(1)</b>
<span class="reserved">import</span> dom from <span class="string"><span class="delimiter">'</span><span class="content">./utils/dom.js</span><span class="delimiter">'</span></span>; <i class="conum" data-value="2"></i><b>(2)</b>

<span class="comment">// Create the ZetaPush Client</span>
const client = <span class="keyword">new</span> ZetaPush.WeakClient({ <i class="conum" data-value="3"></i><b>(3)</b>
  <span class="key">appName</span>: <span class="string"><span class="delimiter">'</span><span class="content">appName</span><span class="delimiter">'</span></span>,
});
<span class="comment">/**
 * Create service to listen incoming messages
 */</span>
const service = client.createService({
  <span class="key">Type</span>: ZetaPushPlatform.Messaging,
  <span class="key">listener</span>: {
    <span class="comment">// Listen incoming messages from the channel 'avengersChannel'</span>
    <span class="key">avengersChannel</span>: ({ data }) =&gt; controller.onAvengersMessage(data), <i class="conum" data-value="4"></i><b>(4)</b>
  },
});

const controller = <span class="keyword">new</span> AvengersController(client, dom);

(async <span class="keyword">function</span> <span class="function">main</span>() {
  <span class="comment">// Expose to template</span>
  window.<span class="predefined">$controller</span> = controller;
  <span class="comment">// Connect to ZetaPush</span>
  await client.connect();
  <span class="comment">// Notify client connected</span>
  controller.onConnectionEstablished();
})();</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import the frontend logic (in the controller)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Import some utils functions</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Object to interact with the ZetaPush platform and the <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Cloud service provided by ZetaPush to listen incoming messages</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value <code>appName</code> in the <em>ZetaPush Client</em> is the id of your application on your ZetaPush account. When you have launch <code>zeta run</code> (or <code>npm run start</code>) you have created an anonymous account and an empty application. All this informations are stored in the file <code>.zetarc</code> just created with the same command.</p>
</div>
<div class="paragraph">
<p>Copy-past the <code>appName</code> from the <em>.zetarc</em> to your <em>ZetaPush Client</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_test_you_application_locally"><a class="anchor" href="#_test_you_application_locally"></a><a class="link" href="#_test_you_application_locally">15.3.3. Test you application locally</a></h4>
<div class="paragraph">
<p>Now, you can test your application. To do this, you need to execute your frontend part locally. For example, you can use <a href="https://caddyserver.com/">Caddy Server</a>.</p>
</div>
<div class="listingblock">
<div class="title">Run locally</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
</pre></td>
  <td class="code"><pre>$ curl https://getcaddy.com | bash
$ cd front/
$ caddy</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Don&#8217;t forget to relaunch your worker with <code>npm run start</code> if you have stop it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then you have access to your application on <code><a href="http://localhost:2015" class="bare">http://localhost:2015</a></code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploy_your_application"><a class="anchor" href="#_deploy_your_application"></a><a class="link" href="#_deploy_your_application">15.4. Deploy your application</a></h3>
<div class="paragraph">
<p>Your application is working but only locally. To deploy your application you just need to launch <code>zeta push</code>. In this application you already have a npm script so you can run :</p>
</div>
<div class="listingblock">
<div class="title">Deploy the application</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command deploys all in once (Front and Worker). It will return you an unique URL to access to your application.</p>
</div>
<div class="paragraph">
<p>Enjoy ! Your Avengers Chat is working and deployed !</p>
</div>
</div>
</div>
</div>
<h1 id="_guides" class="sect0"><a class="anchor" href="#_guides"></a><a class="link" href="#_guides">Guides</a></h1>

<h1 id="_faq" class="sect0"><a class="anchor" href="#_faq"></a><a class="link" href="#_faq">FAQ</a></h1>

<h1 id="_reference" class="sect0"><a class="anchor" href="#_reference"></a><a class="link" href="#_reference">Reference</a></h1>
<div class="sect1">
<h2 id="_command_line_interface"><a class="anchor" href="#_command_line_interface"></a><a class="link" href="#_command_line_interface">16. Command Line Interface</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_initialize_an_application"><a class="anchor" href="#_initialize_an_application"></a><a class="link" href="#_initialize_an_application">16.1. Initialize an application</a></h3>
<div class="paragraph">
<p>The command to initialize an application with the CLI is :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm init @zetapush myApp <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><em>myApp</em> is the name of the directory generated</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This command can take many parameters :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>--developer-login</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This login is the email used by the developer to the connection on the ZetaPush console. It <strong>doesn&#8217;t concerns</strong> any application developed by the developer. It&#8217;s only used to identify the developer account.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>--developer-password</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Like the property <em>--developer-login</em>, this password is only used for the ZetaPush developer account. It <strong>doesn&#8217;t concerns</strong> any application developed by the developer.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>--app-name</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A developer can develops many applications. So for his account on the ZetaPush platform, he need to identify each of them. The <em>appName</em> property is the unique name of an application on a ZetaPush developer account.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>--platform-url</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, the developer use the <em>production environment of ZetaPush</em> to develop and deploy its applications. In most cases, the developer doesn&#8217;t need to set this property. <strong>He just need to use this property if ZetaPush says explicitly to use an other ZetaPush platform.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>--env-name</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An application created by a developer can takes many environments.
The default environment is <em>prod</em> but you can create your own (<em>dev</em>, <em>preprod</em>, &#8230;&#8203;).
An environment is one stage in the life-cycle of the application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_zetapush_cloud_services"><a class="anchor" href="#_zetapush_cloud_services"></a><a class="link" href="#_zetapush_cloud_services">17. ZetaPush Cloud Services</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-06-25 11:35:01 UTC
</div>
</div>
</body>
</html>